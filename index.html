<!doctype html>
<html>
<head>
<meta charset='UTF-8'><meta name='viewport' content='width=device-width initial-scale=1'>
<title>all</title><link href='https://fonts.loli.net/css?family=Open+Sans:400italic,700italic,700,400&subset=latin,latin-ext' rel='stylesheet' type='text/css' /><style type='text/css'>html {overflow-x: initial !important;}:root { --bg-color:#ffffff; --text-color:#333333; --select-text-bg-color:#B5D6FC; --select-text-font-color:auto; --monospace:"Lucida Console",Consolas,"Courier",monospace; --title-bar-height:20px; }
.mac-os-11 { --title-bar-height:28px; }
html { font-size: 14px; background-color: var(--bg-color); color: var(--text-color); font-family: "Helvetica Neue", Helvetica, Arial, sans-serif; -webkit-font-smoothing: antialiased; }
body { margin: 0px; padding: 0px; height: auto; bottom: 0px; top: 0px; left: 0px; right: 0px; font-size: 1rem; line-height: 1.42857; overflow-x: hidden; background: inherit; tab-size: 4; }
iframe { margin: auto; }
a.url { word-break: break-all; }
a:active, a:hover { outline: 0px; }
.in-text-selection, ::selection { text-shadow: none; background: var(--select-text-bg-color); color: var(--select-text-font-color); }
#write { margin: 0px auto; height: auto; width: inherit; word-break: normal; overflow-wrap: break-word; position: relative; white-space: normal; overflow-x: visible; padding-top: 36px; }
#write.first-line-indent p { text-indent: 2em; }
#write.first-line-indent li p, #write.first-line-indent p * { text-indent: 0px; }
#write.first-line-indent li { margin-left: 2em; }
.for-image #write { padding-left: 8px; padding-right: 8px; }
body.typora-export { padding-left: 30px; padding-right: 30px; }
.typora-export .footnote-line, .typora-export li, .typora-export p { white-space: pre-wrap; }
.typora-export .task-list-item input { pointer-events: none; }
@media screen and (max-width: 500px) {
  body.typora-export { padding-left: 0px; padding-right: 0px; }
  #write { padding-left: 20px; padding-right: 20px; }
  .CodeMirror-sizer { margin-left: 0px !important; }
  .CodeMirror-gutters { display: none !important; }
}
#write li > figure:last-child { margin-bottom: 0.5rem; }
#write ol, #write ul { position: relative; }
img { max-width: 100%; vertical-align: middle; image-orientation: from-image; }
button, input, select, textarea { color: inherit; font: inherit; }
input[type="checkbox"], input[type="radio"] { line-height: normal; padding: 0px; }
*, ::after, ::before { box-sizing: border-box; }
#write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write p, #write pre { width: inherit; }
#write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write p { position: relative; }
p { line-height: inherit; }
h1, h2, h3, h4, h5, h6 { break-after: avoid-page; break-inside: avoid; orphans: 4; }
p { orphans: 4; }
h1 { font-size: 2rem; }
h2 { font-size: 1.8rem; }
h3 { font-size: 1.6rem; }
h4 { font-size: 1.4rem; }
h5 { font-size: 1.2rem; }
h6 { font-size: 1rem; }
.md-math-block, .md-rawblock, h1, h2, h3, h4, h5, h6, p { margin-top: 1rem; margin-bottom: 1rem; }
.hidden { display: none; }
.md-blockmeta { color: rgb(204, 204, 204); font-weight: 700; font-style: italic; }
a { cursor: pointer; }
sup.md-footnote { padding: 2px 4px; background-color: rgba(238, 238, 238, 0.7); color: rgb(85, 85, 85); border-radius: 4px; cursor: pointer; }
sup.md-footnote a, sup.md-footnote a:hover { color: inherit; text-transform: inherit; text-decoration: inherit; }
#write input[type="checkbox"] { cursor: pointer; width: inherit; height: inherit; }
figure { overflow-x: auto; margin: 1.2em 0px; max-width: calc(100% + 16px); padding: 0px; }
figure > table { margin: 0px; }
tr { break-inside: avoid; break-after: auto; }
thead { display: table-header-group; }
table { border-collapse: collapse; border-spacing: 0px; width: 100%; overflow: auto; break-inside: auto; text-align: left; }
table.md-table td { min-width: 32px; }
.CodeMirror-gutters { border-right: 0px; background-color: inherit; }
.CodeMirror-linenumber { user-select: none; }
.CodeMirror { text-align: left; }
.CodeMirror-placeholder { opacity: 0.3; }
.CodeMirror pre { padding: 0px 4px; }
.CodeMirror-lines { padding: 0px; }
div.hr:focus { cursor: none; }
#write pre { white-space: pre-wrap; }
#write.fences-no-line-wrapping pre { white-space: pre; }
#write pre.ty-contain-cm { white-space: normal; }
.CodeMirror-gutters { margin-right: 4px; }
.md-fences { font-size: 0.9rem; display: block; break-inside: avoid; text-align: left; overflow: visible; white-space: pre; background: inherit; position: relative !important; }
.md-diagram-panel { width: 100%; margin-top: 10px; text-align: center; padding-top: 0px; padding-bottom: 8px; overflow-x: auto; }
#write .md-fences.mock-cm { white-space: pre-wrap; }
.md-fences.md-fences-with-lineno { padding-left: 0px; }
#write.fences-no-line-wrapping .md-fences.mock-cm { white-space: pre; overflow-x: auto; }
.md-fences.mock-cm.md-fences-with-lineno { padding-left: 8px; }
.CodeMirror-line, twitterwidget { break-inside: avoid; }
.footnotes { opacity: 0.8; font-size: 0.9rem; margin-top: 1em; margin-bottom: 1em; }
.footnotes + .footnotes { margin-top: 0px; }
.md-reset { margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: top; background: 0px 0px; text-decoration: none; text-shadow: none; float: none; position: static; width: auto; height: auto; white-space: nowrap; cursor: inherit; -webkit-tap-highlight-color: transparent; line-height: normal; font-weight: 400; text-align: left; box-sizing: content-box; direction: ltr; }
li div { padding-top: 0px; }
blockquote { margin: 1rem 0px; }
li .mathjax-block, li p { margin: 0.5rem 0px; }
li blockquote { margin: 1rem 0px; }
li { margin: 0px; position: relative; }
blockquote > :last-child { margin-bottom: 0px; }
blockquote > :first-child, li > :first-child { margin-top: 0px; }
.footnotes-area { color: rgb(136, 136, 136); margin-top: 0.714rem; padding-bottom: 0.143rem; white-space: normal; }
#write .footnote-line { white-space: pre-wrap; }
@media print {
  body, html { border: 1px solid transparent; height: 99%; break-after: avoid; break-before: avoid; font-variant-ligatures: no-common-ligatures; }
  #write { margin-top: 0px; padding-top: 0px; border-color: transparent !important; }
  .typora-export * { -webkit-print-color-adjust: exact; }
  .typora-export #write { break-after: avoid; }
  .typora-export #write::after { height: 0px; }
  .is-mac table { break-inside: avoid; }
}
.footnote-line { margin-top: 0.714em; font-size: 0.7em; }
a img, img a { cursor: pointer; }
pre.md-meta-block { font-size: 0.8rem; min-height: 0.8rem; white-space: pre-wrap; background: rgb(204, 204, 204); display: block; overflow-x: hidden; }
p > .md-image:only-child:not(.md-img-error) img, p > img:only-child { display: block; margin: auto; }
#write.first-line-indent p > .md-image:only-child:not(.md-img-error) img { left: -2em; position: relative; }
p > .md-image:only-child { display: inline-block; width: 100%; }
#write .MathJax_Display { margin: 0.8em 0px 0px; }
.md-math-block { width: 100%; }
.md-math-block:not(:empty)::after { display: none; }
.MathJax_ref { fill: currentcolor; }
[contenteditable="true"]:active, [contenteditable="true"]:focus, [contenteditable="false"]:active, [contenteditable="false"]:focus { outline: 0px; box-shadow: none; }
.md-task-list-item { position: relative; list-style-type: none; }
.task-list-item.md-task-list-item { padding-left: 0px; }
.md-task-list-item > input { position: absolute; top: 0px; left: 0px; margin-left: -1.2em; margin-top: calc(1em - 10px); border: none; }
.math { font-size: 1rem; }
.md-toc { min-height: 3.58rem; position: relative; font-size: 0.9rem; border-radius: 10px; }
.md-toc-content { position: relative; margin-left: 0px; }
.md-toc-content::after, .md-toc::after { display: none; }
.md-toc-item { display: block; color: rgb(65, 131, 196); }
.md-toc-item a { text-decoration: none; }
.md-toc-inner:hover { text-decoration: underline; }
.md-toc-inner { display: inline-block; cursor: pointer; }
.md-toc-h1 .md-toc-inner { margin-left: 0px; font-weight: 700; }
.md-toc-h2 .md-toc-inner { margin-left: 2em; }
.md-toc-h3 .md-toc-inner { margin-left: 4em; }
.md-toc-h4 .md-toc-inner { margin-left: 6em; }
.md-toc-h5 .md-toc-inner { margin-left: 8em; }
.md-toc-h6 .md-toc-inner { margin-left: 10em; }
@media screen and (max-width: 48em) {
  .md-toc-h3 .md-toc-inner { margin-left: 3.5em; }
  .md-toc-h4 .md-toc-inner { margin-left: 5em; }
  .md-toc-h5 .md-toc-inner { margin-left: 6.5em; }
  .md-toc-h6 .md-toc-inner { margin-left: 8em; }
}
a.md-toc-inner { font-size: inherit; font-style: inherit; font-weight: inherit; line-height: inherit; }
.footnote-line a:not(.reversefootnote) { color: inherit; }
.md-attr { display: none; }
.md-fn-count::after { content: "."; }
code, pre, samp, tt { font-family: var(--monospace); }
kbd { margin: 0px 0.1em; padding: 0.1em 0.6em; font-size: 0.8em; color: rgb(36, 39, 41); background: rgb(255, 255, 255); border: 1px solid rgb(173, 179, 185); border-radius: 3px; box-shadow: rgba(12, 13, 14, 0.2) 0px 1px 0px, rgb(255, 255, 255) 0px 0px 0px 2px inset; white-space: nowrap; vertical-align: middle; }
.md-comment { color: rgb(162, 127, 3); opacity: 0.8; font-family: var(--monospace); }
code { text-align: left; vertical-align: initial; }
a.md-print-anchor { white-space: pre !important; border-width: initial !important; border-style: none !important; border-color: initial !important; display: inline-block !important; position: absolute !important; width: 1px !important; right: 0px !important; outline: 0px !important; background: 0px 0px !important; text-decoration: initial !important; text-shadow: initial !important; }
.md-inline-math .MathJax_SVG .noError { display: none !important; }
.html-for-mac .inline-math-svg .MathJax_SVG { vertical-align: 0.2px; }
.md-math-block .MathJax_SVG_Display { text-align: center; margin: 0px; position: relative; text-indent: 0px; max-width: none; max-height: none; min-height: 0px; min-width: 100%; width: auto; overflow-y: hidden; display: block !important; }
.MathJax_SVG_Display, .md-inline-math .MathJax_SVG_Display { width: auto; margin: inherit; display: inline-block !important; }
.MathJax_SVG .MJX-monospace { font-family: var(--monospace); }
.MathJax_SVG .MJX-sans-serif { font-family: sans-serif; }
.MathJax_SVG { display: inline; font-style: normal; font-weight: 400; line-height: normal; zoom: 90%; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; }
.MathJax_SVG * { transition: none 0s ease 0s; }
.MathJax_SVG_Display svg { vertical-align: middle !important; margin-bottom: 0px !important; margin-top: 0px !important; }
.os-windows.monocolor-emoji .md-emoji { font-family: "Segoe UI Symbol", sans-serif; }
.md-diagram-panel > svg { max-width: 100%; }
[lang="flow"] svg, [lang="mermaid"] svg { max-width: 100%; height: auto; }
[lang="mermaid"] .node text { font-size: 1rem; }
table tr th { border-bottom: 0px; }
video { max-width: 100%; display: block; margin: 0px auto; }
iframe { max-width: 100%; width: 100%; border: none; }
.highlight td, .highlight tr { border: 0px; }
mark { background: rgb(255, 255, 0); color: rgb(0, 0, 0); }
.md-html-inline .md-plain, .md-html-inline strong, mark .md-inline-math, mark strong { color: inherit; }
mark .md-meta { color: rgb(0, 0, 0); opacity: 0.3 !important; }
@media print {
  .typora-export h1, .typora-export h2, .typora-export h3, .typora-export h4, .typora-export h5, .typora-export h6 { break-inside: avoid; }
}
.md-diagram-panel .messageText { stroke: none !important; }
.md-diagram-panel .start-state { fill: var(--node-fill); }
.md-diagram-panel .edgeLabel rect { opacity: 1 !important; }
.md-require-zoom-fix foreignobject { font-size: var(--mermaid-font-zoom); }


.CodeMirror { height: auto; }
.CodeMirror.cm-s-inner { background: inherit; }
.CodeMirror-scroll { overflow: auto hidden; z-index: 3; }
.CodeMirror-gutter-filler, .CodeMirror-scrollbar-filler { background-color: rgb(255, 255, 255); }
.CodeMirror-gutters { border-right: 1px solid rgb(221, 221, 221); background: inherit; white-space: nowrap; }
.CodeMirror-linenumber { padding: 0px 3px 0px 5px; text-align: right; color: rgb(153, 153, 153); }
.cm-s-inner .cm-keyword { color: rgb(119, 0, 136); }
.cm-s-inner .cm-atom, .cm-s-inner.cm-atom { color: rgb(34, 17, 153); }
.cm-s-inner .cm-number { color: rgb(17, 102, 68); }
.cm-s-inner .cm-def { color: rgb(0, 0, 255); }
.cm-s-inner .cm-variable { color: rgb(0, 0, 0); }
.cm-s-inner .cm-variable-2 { color: rgb(0, 85, 170); }
.cm-s-inner .cm-variable-3 { color: rgb(0, 136, 85); }
.cm-s-inner .cm-string { color: rgb(170, 17, 17); }
.cm-s-inner .cm-property { color: rgb(0, 0, 0); }
.cm-s-inner .cm-operator { color: rgb(152, 26, 26); }
.cm-s-inner .cm-comment, .cm-s-inner.cm-comment { color: rgb(170, 85, 0); }
.cm-s-inner .cm-string-2 { color: rgb(255, 85, 0); }
.cm-s-inner .cm-meta { color: rgb(85, 85, 85); }
.cm-s-inner .cm-qualifier { color: rgb(85, 85, 85); }
.cm-s-inner .cm-builtin { color: rgb(51, 0, 170); }
.cm-s-inner .cm-bracket { color: rgb(153, 153, 119); }
.cm-s-inner .cm-tag { color: rgb(17, 119, 0); }
.cm-s-inner .cm-attribute { color: rgb(0, 0, 204); }
.cm-s-inner .cm-header, .cm-s-inner.cm-header { color: rgb(0, 0, 255); }
.cm-s-inner .cm-quote, .cm-s-inner.cm-quote { color: rgb(0, 153, 0); }
.cm-s-inner .cm-hr, .cm-s-inner.cm-hr { color: rgb(153, 153, 153); }
.cm-s-inner .cm-link, .cm-s-inner.cm-link { color: rgb(0, 0, 204); }
.cm-negative { color: rgb(221, 68, 68); }
.cm-positive { color: rgb(34, 153, 34); }
.cm-header, .cm-strong { font-weight: 700; }
.cm-del { text-decoration: line-through; }
.cm-em { font-style: italic; }
.cm-link { text-decoration: underline; }
.cm-error { color: red; }
.cm-invalidchar { color: red; }
.cm-constant { color: rgb(38, 139, 210); }
.cm-defined { color: rgb(181, 137, 0); }
div.CodeMirror span.CodeMirror-matchingbracket { color: rgb(0, 255, 0); }
div.CodeMirror span.CodeMirror-nonmatchingbracket { color: rgb(255, 34, 34); }
.cm-s-inner .CodeMirror-activeline-background { background: inherit; }
.CodeMirror { position: relative; overflow: hidden; }
.CodeMirror-scroll { height: 100%; outline: 0px; position: relative; box-sizing: content-box; background: inherit; }
.CodeMirror-sizer { position: relative; }
.CodeMirror-gutter-filler, .CodeMirror-hscrollbar, .CodeMirror-scrollbar-filler, .CodeMirror-vscrollbar { position: absolute; z-index: 6; display: none; }
.CodeMirror-vscrollbar { right: 0px; top: 0px; overflow: hidden; }
.CodeMirror-hscrollbar { bottom: 0px; left: 0px; overflow: hidden; }
.CodeMirror-scrollbar-filler { right: 0px; bottom: 0px; }
.CodeMirror-gutter-filler { left: 0px; bottom: 0px; }
.CodeMirror-gutters { position: absolute; left: 0px; top: 0px; padding-bottom: 30px; z-index: 3; }
.CodeMirror-gutter { white-space: normal; height: 100%; box-sizing: content-box; padding-bottom: 30px; margin-bottom: -32px; display: inline-block; }
.CodeMirror-gutter-wrapper { position: absolute; z-index: 4; background: 0px 0px !important; border: none !important; }
.CodeMirror-gutter-background { position: absolute; top: 0px; bottom: 0px; z-index: 4; }
.CodeMirror-gutter-elt { position: absolute; cursor: default; z-index: 4; }
.CodeMirror-lines { cursor: text; }
.CodeMirror pre { border-radius: 0px; border-width: 0px; background: 0px 0px; font-family: inherit; font-size: inherit; margin: 0px; white-space: pre; overflow-wrap: normal; color: inherit; z-index: 2; position: relative; overflow: visible; }
.CodeMirror-wrap pre { overflow-wrap: break-word; white-space: pre-wrap; word-break: normal; }
.CodeMirror-code pre { border-right: 30px solid transparent; width: fit-content; }
.CodeMirror-wrap .CodeMirror-code pre { border-right: none; width: auto; }
.CodeMirror-linebackground { position: absolute; left: 0px; right: 0px; top: 0px; bottom: 0px; z-index: 0; }
.CodeMirror-linewidget { position: relative; z-index: 2; overflow: auto; }
.CodeMirror-wrap .CodeMirror-scroll { overflow-x: hidden; }
.CodeMirror-measure { position: absolute; width: 100%; height: 0px; overflow: hidden; visibility: hidden; }
.CodeMirror-measure pre { position: static; }
.CodeMirror div.CodeMirror-cursor { position: absolute; visibility: hidden; border-right: none; width: 0px; }
.CodeMirror div.CodeMirror-cursor { visibility: hidden; }
.CodeMirror-focused div.CodeMirror-cursor { visibility: inherit; }
.cm-searching { background: rgba(255, 255, 0, 0.4); }
@media print {
  .CodeMirror div.CodeMirror-cursor { visibility: hidden; }
}


:root {
    --side-bar-bg-color: #fafafa;
    --control-text-color: #777;
}

@include-when-export url(https://fonts.loli.net/css?family=Open+Sans:400italic,700italic,700,400&subset=latin,latin-ext);

/* open-sans-regular - latin-ext_latin */
  /* open-sans-italic - latin-ext_latin */
    /* open-sans-700 - latin-ext_latin */
    /* open-sans-700italic - latin-ext_latin */
  html {
    font-size: 16px;
}

body {
    font-family: "Open Sans","Clear Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
    color: rgb(51, 51, 51);
    line-height: 1.6;
}

#write {
    max-width: 860px;
  	margin: 0 auto;
  	padding: 30px;
    padding-bottom: 100px;
}

@media only screen and (min-width: 1400px) {
	#write {
		max-width: 1024px;
	}
}

@media only screen and (min-width: 1800px) {
	#write {
		max-width: 1200px;
	}
}

#write > ul:first-child,
#write > ol:first-child{
    margin-top: 30px;
}

a {
    color: #4183C4;
}
h1,
h2,
h3,
h4,
h5,
h6 {
    position: relative;
    margin-top: 1rem;
    margin-bottom: 1rem;
    font-weight: bold;
    line-height: 1.4;
    cursor: text;
}
h1:hover a.anchor,
h2:hover a.anchor,
h3:hover a.anchor,
h4:hover a.anchor,
h5:hover a.anchor,
h6:hover a.anchor {
    text-decoration: none;
}
h1 tt,
h1 code {
    font-size: inherit;
}
h2 tt,
h2 code {
    font-size: inherit;
}
h3 tt,
h3 code {
    font-size: inherit;
}
h4 tt,
h4 code {
    font-size: inherit;
}
h5 tt,
h5 code {
    font-size: inherit;
}
h6 tt,
h6 code {
    font-size: inherit;
}
h1 {
    font-size: 2.25em;
    line-height: 1.2;
    border-bottom: 1px solid #eee;
}
h2 {
    font-size: 1.75em;
    line-height: 1.225;
    border-bottom: 1px solid #eee;
}

/*@media print {
    .typora-export h1,
    .typora-export h2 {
        border-bottom: none;
        padding-bottom: initial;
    }

    .typora-export h1::after,
    .typora-export h2::after {
        content: "";
        display: block;
        height: 100px;
        margin-top: -96px;
        border-top: 1px solid #eee;
    }
}*/

h3 {
    font-size: 1.5em;
    line-height: 1.43;
}
h4 {
    font-size: 1.25em;
}
h5 {
    font-size: 1em;
}
h6 {
   font-size: 1em;
    color: #777;
}
p,
blockquote,
ul,
ol,
dl,
table{
    margin: 0.8em 0;
}
li>ol,
li>ul {
    margin: 0 0;
}
hr {
    height: 2px;
    padding: 0;
    margin: 16px 0;
    background-color: #e7e7e7;
    border: 0 none;
    overflow: hidden;
    box-sizing: content-box;
}

li p.first {
    display: inline-block;
}
ul,
ol {
    padding-left: 30px;
}
ul:first-child,
ol:first-child {
    margin-top: 0;
}
ul:last-child,
ol:last-child {
    margin-bottom: 0;
}
blockquote {
    border-left: 4px solid #dfe2e5;
    padding: 0 15px;
    color: #777777;
}
blockquote blockquote {
    padding-right: 0;
}
table {
    padding: 0;
    word-break: initial;
}
table tr {
    border-top: 1px solid #dfe2e5;
    margin: 0;
    padding: 0;
}
table tr:nth-child(2n),
thead {
    background-color: #f8f8f8;
}
table th {
    font-weight: bold;
    border: 1px solid #dfe2e5;
    border-bottom: 0;
    margin: 0;
    padding: 6px 13px;
}
table td {
    border: 1px solid #dfe2e5;
    margin: 0;
    padding: 6px 13px;
}
table th:first-child,
table td:first-child {
    margin-top: 0;
}
table th:last-child,
table td:last-child {
    margin-bottom: 0;
}

.CodeMirror-lines {
    padding-left: 4px;
}

.code-tooltip {
    box-shadow: 0 1px 1px 0 rgba(0,28,36,.3);
    border-top: 1px solid #eef2f2;
}

.md-fences,
code,
tt {
    border: 1px solid #e7eaed;
    background-color: #f8f8f8;
    border-radius: 3px;
    padding: 0;
    padding: 2px 4px 0px 4px;
    font-size: 0.9em;
}

code {
    background-color: #f3f4f4;
    padding: 0 2px 0 2px;
}

.md-fences {
    margin-bottom: 15px;
    margin-top: 15px;
    padding-top: 8px;
    padding-bottom: 6px;
}


.md-task-list-item > input {
  margin-left: -1.3em;
}

@media print {
    html {
        font-size: 13px;
    }
    table,
    pre {
        page-break-inside: avoid;
    }
    pre {
        word-wrap: break-word;
    }
}

.md-fences {
	background-color: #f8f8f8;
}
#write pre.md-meta-block {
	padding: 1rem;
    font-size: 85%;
    line-height: 1.45;
    background-color: #f7f7f7;
    border: 0;
    border-radius: 3px;
    color: #777777;
    margin-top: 0 !important;
}

.mathjax-block>.code-tooltip {
	bottom: .375rem;
}

.md-mathjax-midline {
    background: #fafafa;
}

#write>h3.md-focus:before{
	left: -1.5625rem;
	top: .375rem;
}
#write>h4.md-focus:before{
	left: -1.5625rem;
	top: .285714286rem;
}
#write>h5.md-focus:before{
	left: -1.5625rem;
	top: .285714286rem;
}
#write>h6.md-focus:before{
	left: -1.5625rem;
	top: .285714286rem;
}
.md-image>.md-meta {
    /*border: 1px solid #ddd;*/
    border-radius: 3px;
    padding: 2px 0px 0px 4px;
    font-size: 0.9em;
    color: inherit;
}

.md-tag {
    color: #a7a7a7;
    opacity: 1;
}

.md-toc { 
    margin-top:20px;
    padding-bottom:20px;
}

.sidebar-tabs {
    border-bottom: none;
}

#typora-quick-open {
    border: 1px solid #ddd;
    background-color: #f8f8f8;
}

#typora-quick-open-item {
    background-color: #FAFAFA;
    border-color: #FEFEFE #e5e5e5 #e5e5e5 #eee;
    border-style: solid;
    border-width: 1px;
}

/** focus mode */
.on-focus-mode blockquote {
    border-left-color: rgba(85, 85, 85, 0.12);
}

header, .context-menu, .megamenu-content, footer{
    font-family: "Segoe UI", "Arial", sans-serif;
}

.file-node-content:hover .file-node-icon,
.file-node-content:hover .file-node-open-state{
    visibility: visible;
}

.mac-seamless-mode #typora-sidebar {
    background-color: #fafafa;
    background-color: var(--side-bar-bg-color);
}

.md-lang {
    color: #b4654d;
}

.html-for-mac .context-menu {
    --item-hover-bg-color: #E6F0FE;
}

#md-notification .btn {
    border: 0;
}

.dropdown-menu .divider {
    border-color: #e5e5e5;
}

.ty-preferences .window-content {
    background-color: #fafafa;
}

.ty-preferences .nav-group-item.active {
    color: white;
    background: #999;
}


</style>
</head>
<body class='typora-export os-windows'>
<div id='write'  class=''><p><img src="all.assets/Linera-Header_1920x284px.svg" referrerpolicy="no-referrer" alt="The Linera banner"></p><h1><a name="the-linera-developer-manualhttpslineradevintroductionhtmlthe-linera-developer-manual" class="md-header-anchor"></a><a href='https://linera.dev/introduction.html#the-linera-developer-manual'><span>The Linera Developer Manual</span></a></h1><p><span>Welcome to the developer manual of Linera, a decentralized protocol designed for </span><strong><span>highly scalable, low-latency Web3 applications</span></strong><span>.</span></p><p><span>This documentation is intended for developers who wish to learn more about Linera and its programming model by prototyping applications on top of the Linera Rust SDK.</span></p><blockquote><p><strong><span>NEW: Publish and test your Web3 application on the Linera Devnet!</span></strong></p><p><span>Install </span><a href='https://linera.dev/getting_started/installation.html#installing-from-cratesio'><span>the Linera CLI tool</span></a><span> then follow the instructions on </span><a href='https://linera.dev/getting_started/hello_linera.html#using-the-devnet'><span>this page</span></a><span> to claim a microchain and publish your first application on the current Devnet.</span></p></blockquote><p><span>To join our community and get involved in the development of the Linera ecosystem, check out our </span><a href='https://github.com/linera-io/linera-protocol'><span>GitHub repository</span></a><span>, our </span><a href='https://linera.io/'><span>website</span></a><span>, and find us on social media channels such as </span><a href='https://www.youtube.com/@linera_io'><span>youtube</span></a><span>, </span><a href='https://twitter.com/linera_io'><span>twitter</span></a><span>, </span><a href='https://t.me/linera_official'><span>telegram</span></a><span>, and </span><a href='https://discord.gg/linera'><span>discord</span></a><span>.</span></p><p><span>Let&#39;s get started!</span></p><h1><a name="getting-startedhttpslineradevgettingstartedhtmlgetting-started" class="md-header-anchor"></a><a href='https://linera.dev/getting_started.html#getting-started'><span>Getting started</span></a></h1><p><span>In this section, we will cover the necessary steps to install the Linera toolchain and give a short example to get started with the Linera SDK.</span></p><h1><a name="installationhttpslineradevgettingstartedinstallationhtmlinstallation" class="md-header-anchor"></a><a href='https://linera.dev/getting_started/installation.html#installation'><span>Installation</span></a></h1><p><span>Let&#39;s start with the installation of the Linera development tools.</span></p><h2><a name="overviewhttpslineradevgettingstartedinstallationhtmloverview" class="md-header-anchor"></a><a href='https://linera.dev/getting_started/installation.html#overview'><span>Overview</span></a></h2><p><span>The Linera toolchain consist of two crates:</span></p><ul><li><p><code>linera-sdk</code><span> is the main library to program Linera applications in Rust. It also includes the Wasm test runner binary </span><code>linera-wasm-test-runner</code><span>.</span></p></li><li><p><code>linera-service</code><span> defines a number of binaries, including:</span></p><ul><li><code>linera</code><span> -- the main client tool, used to operate development wallets,</span></li><li><code>linera-proxy</code><span> -- the proxy service, acting as a public entrypoint for each validator,</span></li><li><code>linera-server</code><span> -- the service run by each worker of a validator, hidden behind the proxy.</span></li></ul></li></ul><h2><a name="requirementshttpslineradevgettingstartedinstallationhtmlrequirements" class="md-header-anchor"></a><a href='https://linera.dev/getting_started/installation.html#requirements'><span>Requirements</span></a></h2><p><span>The operating systems currently supported by the Linera toolchain can be summarized as follows:</span></p><figure><table><thead><tr><th><span>Linux x86 64-bit</span></th><th><span>Mac OS (M1 / M2)</span></th><th><span>Mac OS (x86)</span></th><th><span>Windows</span></th></tr></thead><tbody><tr><td><span>✓ Main platform</span></td><td><span>✓ Working</span></td><td><span>✓ Working</span></td><td><span>Untested</span></td></tr></tbody></table></figure><p><span>The main prerequisites to install the Linera toolchain are Rust, Wasm, and Protoc. They can be installed as follows on Linux:</span></p><ul><li><p><span>Rust and Wasm</span></p><ul><li><code>curl --proto &#39;=https&#39; --tlsv1.2 -sSf https://sh.rustup.rs | sh</code></li><li><code>rustup target add wasm32-unknown-unknown</code></li></ul></li><li><p><span>Protoc</span></p><ul><li><code>curl -LO https://github.com/protocolbuffers/protobuf/releases/download/v21.11/protoc-21.11-linux-x86_64.zip</code></li><li><code>unzip protoc-21.11-linux-x86_64.zip -d $HOME/.local</code></li><li><span>If </span><code>~/.local</code><span> is not in your path, add it: </span><code>export PATH=&quot;$PATH:$HOME/.local/bin&quot;</code></li></ul></li><li><p><span>On certain Linux distributions, you may have to install development packages such as </span><code>g++</code><span>, </span><code>libclang-dev</code><span> and </span><code>libssl-dev</code><span>.</span></p></li></ul><p><span>For MacOS support and for additional requirements needed to test the Linera protocol itself, see the installation section on </span><a href='https://github.com/linera-io/linera-protocol/blob/main/INSTALL.md'><span>GitHub</span></a><span>.</span></p><p><span>This manual was tested with the following Rust toolchain:</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="text"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="text"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[toolchain]</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">channel = "1.75.0"</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">components = [ "clippy", "rustfmt", "rust-src" ]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">targets = [ "wasm32-unknown-unknown" ]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">profile = "minimal"</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 115px;"></div><div class="CodeMirror-gutters" style="display: none; height: 115px;"></div></div></div></pre><h2><a name="installing-from-cratesiohttpslineradevgettingstartedinstallationhtmlinstalling-from-cratesio" class="md-header-anchor"></a><a href='https://linera.dev/getting_started/installation.html#installing-from-cratesio'><span>Installing from crates.io</span></a></h2><p><span>You may install the Linera binaries with</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="bash"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">cargo install linera-sdk@0.9.0</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">cargo install linera-service@0.9.0</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 46px;"></div><div class="CodeMirror-gutters" style="display: none; height: 46px;"></div></div></div></pre><p><span>and use </span><code>linera-sdk</code><span> as a library for Linera Wasm applications:</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="bash"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">cargo add linera-sdk@0.9.0</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 23px;"></div><div class="CodeMirror-gutters" style="display: none; height: 23px;"></div></div></div></pre><p><span>The version number </span><code>0.9.0</code><span> corresponds to the current Devnet of Linera and may change frequently.</span></p><h2><a name="installing-from-githubhttpslineradevgettingstartedinstallationhtmlinstalling-from-github" class="md-header-anchor"></a><a href='https://linera.dev/getting_started/installation.html#installing-from-github'><span>Installing from GitHub</span></a></h2><p><span>Download the source from </span><a href='https://github.com/linera-io/linera-protocol'><span>GitHub</span></a><span>:</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="bash"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">git</span> clone https://github.com/linera-io/linera-protocol.git</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">git</span> checkout <span class="cm-attribute">-t</span> origin/devnet_2024_02_20 &nbsp;<span class="cm-comment"># Current release branch</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 46px;"></div><div class="CodeMirror-gutters" style="display: none; height: 46px;"></div></div></div></pre><p><span>To install the Linera toolchain locally from source, you may run:</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="bash"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">cargo install <span class="cm-attribute">--path</span> linera-sdk</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">cargo install <span class="cm-attribute">--path</span> linera-service</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 46px;"></div><div class="CodeMirror-gutters" style="display: none; height: 46px;"></div></div></div></pre><p><span>Alternatively, for developing and debugging, you may instead use the binaries compiled in debug mode, e.g. using </span><code>export PATH=&quot;$PWD/target/debug:$PATH&quot;</code><span>.</span></p><p><span>This manual was tested against the following commit of the </span><a href='https://github.com/linera-io/linera-protocol'><span>repository</span></a><span>:</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="text"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="text"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">c6f5b00b2017e6158dbdc090bf70e3e0fc71f4c6</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 23px;"></div><div class="CodeMirror-gutters" style="display: none; height: 23px;"></div></div></div></pre><h2><a name="bash-helper-optionalhttpslineradevgettingstartedinstallationhtmlbash-helper-optional" class="md-header-anchor"></a><a href='https://linera.dev/getting_started/installation.html#bash-helper-optional'><span>Bash helper (optional)</span></a></h2><p><span>Consider adding the output of </span><code>linera net helper</code><span> to your </span><code>~/.bash_profile</code><span> to help with </span><a href='https://linera.dev/core_concepts/wallets.html#automation-in-bash'><span>automation</span></a><span>.</span></p><h2><a name="getting-helphttpslineradevgettingstartedinstallationhtmlgetting-help" class="md-header-anchor"></a><a href='https://linera.dev/getting_started/installation.html#getting-help'><span>Getting help</span></a></h2><p><span>If installation fails, reach out to the team (e.g. on </span><a href='https://discord.gg/linera'><span>Discord</span></a><span>) to help troubleshoot your issue or </span><a href='https://github.com/linera-io/linera-protocol/issues/new'><span>create an issue</span></a><span> on GitHub.</span></p><h1><a name="hello-linerahttpslineradevgettingstartedhellolinerahtmlhello-linera" class="md-header-anchor"></a><a href='https://linera.dev/getting_started/hello_linera.html#hello-linera'><span>Hello, Linera</span></a></h1><p><span>This section is about interacting with the Devnet, running a local development network, then compiling and deploying your first application from scratch.</span></p><p><span>By the end of this section, you&#39;ll have a </span><a href='https://linera.dev/core_concepts/microchains.html'><span>microchain</span></a><span> on the Devnet and/or on your local network, and a working application that can be queried using GraphQL.</span></p><h2><a name="using-the-devnethttpslineradevgettingstartedhellolinerahtmlusing-the-devnet" class="md-header-anchor"></a><a href='https://linera.dev/getting_started/hello_linera.html#using-the-devnet'><span>Using the Devnet</span></a></h2><p><span>The Linera Devnet is a deployment of the Linera protocol that&#39;s useful for developers. It should not be considered stable, and can be restarted from a clean slate and new genesis at any time.</span></p><p><span>To interact with the Devnet, some tokens are needed. A Faucet service is available to create new microchains and obtain some test tokens. To do so, this must be configured when initializing the wallet:</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="bash"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">linera wallet init <span class="cm-attribute">--with-new-chain</span> <span class="cm-attribute">--faucet</span> https://faucet.devnet.linera.net</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 23px;"></div><div class="CodeMirror-gutters" style="display: none; height: 23px;"></div></div></div></pre><p><span>This creates a new microchain on Devnet with some initial test tokens, and the chain is automatically added to the newly instantiated wallet.</span></p><blockquote><p><span>Make sure to use a Linera toolchain </span><a href='https://linera.dev/getting_started/installation.html#installing-from-cratesio'><span>compatible with the current Devnet</span></a><span>.</span></p></blockquote><h2><a name="starting-a-local-test-networkhttpslineradevgettingstartedhellolinerahtmlstarting-a-local-test-network" class="md-header-anchor"></a><a href='https://linera.dev/getting_started/hello_linera.html#starting-a-local-test-network'><span>Starting a Local Test Network</span></a></h2><p><span>Another option is to start your own local development network. A development network consists of a number of </span><a href='https://linera.dev/advanced_topics/validators.html'><span>validators</span></a><span>, each of which consist of an ingress proxy (aka. a &quot;load balancer&quot;) and a number of workers (aka. &quot;physical shards&quot;).</span></p><p><span>To start a local network, run the following command:</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="bash"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">linera net up</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 23px;"></div><div class="CodeMirror-gutters" style="display: none; height: 23px;"></div></div></div></pre><p><span>This will start a validator with the default number of shards and create a temporary directory storing the entire network state.</span></p><p><span>This will set up a number of initial chains and create an initial wallet to operate them.</span></p><h3><a name="using-the-initial-test-wallethttpslineradevgettingstartedhellolinerahtmlusing-the-initial-test-wallet" class="md-header-anchor"></a><a href='https://linera.dev/getting_started/hello_linera.html#using-the-initial-test-wallet'><span>Using the Initial Test Wallet</span></a></h3><p><code>linera net up</code><span> prints Bash statements on its standard output to help you configure your terminal to use the initial wallet of the new test network, for instance:</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="bash"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">export</span> <span class="cm-def">LINERA_WALLET</span><span class="cm-operator">=</span><span class="cm-string">"/var/folders/3d/406tbklx3zx2p3_hzzpfqdbc0000gn/T/.tmpvJ6lJI/wallet.json"</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">export</span> <span class="cm-def">LINERA_STORAGE</span><span class="cm-operator">=</span><span class="cm-string">"rocksdb:/var/folders/3d/406tbklx3zx2p3_hzzpfqdbc0000gn/T/.tmpvJ6lJI/linera.db"</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 46px;"></div><div class="CodeMirror-gutters" style="display: none; height: 46px;"></div></div></div></pre><p><span>This wallet is only valid for the lifetime of a single network. Every time a local network is restarted, the wallet needs to be reconfigured.</span></p><h2><a name="interacting-with-the-networkhttpslineradevgettingstartedhellolinerahtmlinteracting-with-the-network" class="md-header-anchor"></a><a href='https://linera.dev/getting_started/hello_linera.html#interacting-with-the-network'><span>Interacting with the Network</span></a></h2><blockquote><p><span>In the following examples, we assume that either the wallet was initialized to interact with the Devnet or the variables </span><code>LINERA_WALLET</code><span> and </span><code>LINERA_STORAGE</code><span> are both set and point to the initial wallet of the running local network.</span></p></blockquote><p><span>The main way of interacting with the network and deploying applications is using the </span><code>linera</code><span> client.</span></p><p><span>To check that the network is working, you can synchronize your </span><a href='https://linera.dev/core_concepts/wallets.html'><span>default chain</span></a><span> with the rest of the network and display the chain balance as follows:</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="bash"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">linera sync</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">linera query-balance</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 46px;"></div><div class="CodeMirror-gutters" style="display: none; height: 46px;"></div></div></div></pre><p><span>You should see an output number, e.g. </span><code>10</code><span>.</span></p><h2><a name="building-an-example-applicationhttpslineradevgettingstartedhellolinerahtmlbuilding-an-example-application" class="md-header-anchor"></a><a href='https://linera.dev/getting_started/hello_linera.html#building-an-example-application'><span>Building an Example Application</span></a></h2><p><span>Applications running on Linera are </span><a href='https://webassembly.org/'><span>Wasm</span></a><span> bytecode. Each validator and client has a built-in Wasm virtual machine (VM) which can execute bytecode.</span></p><p><span>Let&#39;s build the </span><code>counter</code><span> application from the </span><code>examples/</code><span> subdirectory:</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="bash"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">cd</span> examples/counter &amp;&amp; cargo build <span class="cm-attribute">--release</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 23px;"></div><div class="CodeMirror-gutters" style="display: none; height: 23px;"></div></div></div></pre><blockquote><p><span>Note: This will automatically build Wasm, not native code, thanks to the configuration file </span><code>examples/.cargo/config.toml</code><span>.</span></p></blockquote><h2><a name="publishing-your-applicationhttpslineradevgettingstartedhellolinerahtmlpublishing-your-application" class="md-header-anchor"></a><a href='https://linera.dev/getting_started/hello_linera.html#publishing-your-application'><span>Publishing your Application</span></a></h2><p><span>You can publish the bytecode and create an application using it on your local network using the </span><code>linera</code><span> client&#39;s </span><code>publish-and-create</code><span> command and provide:</span></p><ol><li><span>The location of the contract bytecode</span></li><li><span>The location of the service bytecode</span></li><li><span>The JSON encoded initialization arguments</span></li></ol><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="bash"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">linera publish-and-create \</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  ../target/wasm32-unknown-unknown/release/counter_{contract,service}.wasm \</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-attribute">--json-argument</span> <span class="cm-string">"42"</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 69px;"></div><div class="CodeMirror-gutters" style="display: none; height: 69px;"></div></div></div></pre><p><span>Congratulations! You&#39;ve published your first application on Linera!</span></p><h2><a name="querying-your-applicationhttpslineradevgettingstartedhellolinerahtmlquerying-your-application" class="md-header-anchor"></a><a href='https://linera.dev/getting_started/hello_linera.html#querying-your-application'><span>Querying your Application</span></a></h2><p><span>Now let&#39;s query your application to get the current counter value. To do that, we need to use the client running in </span><a href='https://linera.dev/core_concepts/node_service.html'><em><span>service</span></em><span> mode</span></a><span>. This will expose a bunch of APIs locally which we can use to interact with applications on the network.</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="bash"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">linera <span class="cm-builtin">service</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 23px;"></div><div class="CodeMirror-gutters" style="display: none; height: 23px;"></div></div></div></pre><p><span>Navigate to </span><code>http://localhost:8080</code><span> in your browser to access the GraphiQL, the </span><a href='https://graphql.org/'><span>GraphQL</span></a><span> IDE. We&#39;ll look at this in more detail in a </span><a href='https://linera.dev/core_concepts/node_service.html#graphiql-ide'><span>later section</span></a><span>; for now, list the applications deployed on your default chain e476… by running:</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="gql"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="gql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">query {</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  applications(</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  chainId: "e476187f6ddfeb9d588c7b45d3df334d5501d6499b3f9ad5595cae86cce16a65"</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  ) {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  id</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  description</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  link</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 207px;"></div><div class="CodeMirror-gutters" style="display: none; height: 207px;"></div></div></div></pre><p><span>Since we&#39;ve only deployed one application, the results returned have a single entry.</span></p><p><span>At the bottom of the returned JSON there is a field </span><code>link</code><span>. To interact with your application copy and paste the link into a new browser tab.</span></p><p><span>Finally, to query the counter value, run:</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="gql"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="gql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">query {</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  value</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 69px;"></div><div class="CodeMirror-gutters" style="display: none; height: 69px;"></div></div></div></pre><p><span>This will return a value of </span><code>42</code><span>, which is the initialization argument we specified when deploying our application.</span></p><h1><a name="the-linera-protocolhttpslineradevcoreconceptshtmlthe-linera-protocol" class="md-header-anchor"></a><a href='https://linera.dev/core_concepts.html#the-linera-protocol'><span>The Linera Protocol</span></a></h1><p><span>We now describe the main concepts of the Linera protocol in more details.</span></p><p>&nbsp;</p><h1><a name="overviewhttpslineradevcoreconceptsoverviewhtmloverview" class="md-header-anchor"></a><a href='https://linera.dev/core_concepts/overview.html#overview'><span>Overview</span></a></h1><p><span>Linera is a decentralized infrastructure optimized for Web3 applications that require guaranteed performance for an unlimited number of active users.</span></p><p><span>The core idea of the Linera protocol is to run many lightweight blockchains, called </span><strong><span>microchains</span></strong><span>, in parallel in a single set of validators.</span></p><h2><a name="how-does-it-workhttpslineradevcoreconceptsoverviewhtmlhow-does-it-work" class="md-header-anchor"></a><a href='https://linera.dev/core_concepts/overview.html#how-does-it-work'><span>How does it work?</span></a></h2><p><span>In Linera, user wallets operate their own microchains. The owner of a chain chooses when to add new blocks to the chain and what goes inside the blocks. Such chains with a single user are called </span><strong><span>user chains</span></strong><span>.</span></p><p><span>Users may add new blocks to their chains in order to process </span><strong><span>incoming messages</span></strong><span> from other chains or to execute secure </span><strong><span>operations</span></strong><span> on their accounts, for instance to transfer assets to another user.</span></p><p><span>Importantly, validators ensure that all new blocks are </span><strong><span>valid</span></strong><span>. For instance, transfer operations must originate from accounts with sufficient funds; and incoming messages must have been actually sent from another chain. Blocks are verified by validators in the same way for every chain.</span></p><p><span>A Linera </span><strong><span>application</span></strong><span> is a Wasm program that defines its own state and operations. Users can publish bytecode and initialize an application on one chain, and it will be automatically deployed to all chains where it is needed, with a separate state on each chain.</span></p><p><span>To ensure coordination across chains, an application may rely on asynchronous </span><strong><span>cross-chain messages</span></strong><span>. Message payloads are application-specific and opaque to the rest of the system.</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="ignore" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="ignore"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ┌───┐ &nbsp; &nbsp; ┌───┐ &nbsp; &nbsp; ┌───┐</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Chain A │ &nbsp; ├────►│ &nbsp; ├────►│ &nbsp; │</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; └───┘ &nbsp; &nbsp; └───┘ &nbsp; &nbsp; └───┘</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ▲</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ┌─────────┘</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; │</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ┌───┐ &nbsp; &nbsp; ┌─┴─┐ &nbsp; &nbsp; ┌───┐</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Chain B │ &nbsp; ├────►│ &nbsp; ├────►│ &nbsp; │</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; └───┘ &nbsp; &nbsp; └─┬─┘ &nbsp; &nbsp; └───┘</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; │ &nbsp; &nbsp; &nbsp; &nbsp; ▲</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; │ &nbsp; &nbsp; &nbsp; &nbsp; │</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ▼ &nbsp; &nbsp; &nbsp; &nbsp; │</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ┌───┐ &nbsp; &nbsp; ┌───┐ &nbsp; &nbsp; ┌─┴─┐</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Chain C │ &nbsp; ├────►│ &nbsp; ├────►│ &nbsp; │</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; └───┘ &nbsp; &nbsp; └───┘ &nbsp; &nbsp; └───┘</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 345px;"></div><div class="CodeMirror-gutters" style="display: none; height: 345px;"></div></div></div></pre><p><span>The number of applications present on a single chain is not limited. On the same chain, applications are </span><strong><span>composed</span></strong><span> as usual using synchronous calls.</span></p><p><span>The current Linera SDK uses </span><strong><span>Rust</span></strong><span> as a source language to create Wasm applications. It relies on the normal Rust toolchains so that Rust programmers can work in their preferred environments.</span></p><h2><a name="how-does-linera-compare-to-existing-multi-chain-infrastructurehttpslineradevcoreconceptsoverviewhtmlhow-does-linera-compare-to-existing-multi-chain-infrastructure" class="md-header-anchor"></a><a href='https://linera.dev/core_concepts/overview.html#how-does-linera-compare-to-existing-multi-chain-infrastructure'><span>How does Linera compare to existing multi-chain infrastructure?</span></a></h2><p><span>Linera is the first infrastructure designed to support many chains in parallel, and notably an arbitrary number of </span><strong><span>user chains</span></strong><span> meant to be operated by user wallets.</span></p><p><span>In traditional multi-chain infrastructures, each chain usually runs a full blockchain protocol in a separate set of validators. Creating a new chain or exchanging messages between chains is expensive. As a result, the total number of chains is generally limited. Some chains may be specialized to a given use case: these are called &quot;app chains&quot;.</span></p><p><span>In contrast, Linera is optimized for a large number of user chains:</span></p><ul><li><span>Users only create blocks in their chain when needed;</span></li><li><span>Creating a microchain does not require onboarding validators;</span></li><li><span>All chains have the same level of security;</span></li><li><span>Microchains communicate efficiently using the internal networks of validators;</span></li><li><span>Validators are internally sharded (like a regular web service) and may adjust their capacity elastically by adding or removing internal workers.</span></li></ul><blockquote><p><span>Besides user chains, the </span><a href='https://linera.io/whitepaper'><span>Linera protocol</span></a><span> is designed to support other types of microchains, called &quot;permissioned&quot; and &quot;public&quot; chains. Public chains are operated by validators. In this regard, they are similar to classical blockchains. Permissioned chains are meant to be used for temporary interactions between users, such as atomic swaps.</span></p></blockquote><h2><a name="why-build-on-top-of-linerahttpslineradevcoreconceptsoverviewhtmlwhy-build-on-top-of-linera" class="md-header-anchor"></a><a href='https://linera.dev/core_concepts/overview.html#why-build-on-top-of-linera'><span>Why build on top of Linera?</span></a></h2><p><span>We believe that many high-value use cases are currently out of reach of existing Web3 infrastructures because of the challenges of serving </span><strong><span>many active users</span></strong><span> simultaneously without degrading user experience (unpredictable fees, latency, etc).</span></p><p><span>Examples of applications that require processing time-sensitive transactions created by many simultaneous users include:</span></p><ul><li><span>real-time micro-payments and micro-rewards,</span></li><li><span>social data feeds,</span></li><li><span>real-time auction systems,</span></li><li><span>turn-based games,</span></li><li><span>version control systems for software, data pipelines, or AI training pipelines.</span></li></ul><p><span>Lightweight user chains are instrumental in providing elastic scalability but they have other benefits as well. Because user chains have fewer blocks than traditional blockchains, in Linera, the full-nodes of user chains will be embedded into the users&#39; wallets, typically deployed as a browser extension.</span></p><p><span>This means that Web UIs connected to a wallet will be able to query the state of the user chain directly (no API provider, no light client) using familiar frameworks (React/GraphQL). Furthermore, wallets will be able to leverage the full node as well for security purposes, including to display meaningful confirmation messages to users.</span></p><h2><a name="what-is-the-current-state-of-the-development-of-linerahttpslineradevcoreconceptsoverviewhtmlwhat-is-the-current-state-of-the-development-of-linera" class="md-header-anchor"></a><a href='https://linera.dev/core_concepts/overview.html#what-is-the-current-state-of-the-development-of-linera'><span>What is the current state of the development of Linera?</span></a></h2><p><span>The </span><a href='https://github.com/linera-io/linera-protocol'><span>reference open-source implementation</span></a><span> of Linera is under active development. It already includes a Web3 SDK with the necessary features to prototype simple Web3 applications and test them locally on the same machine. Notably, Web UIs (possibly reactive) can already be built on top of Wasm-embedded GraphQL services, and tested locally in the browser.</span></p><p><span>The main limitations of our current Web3 SDK include:</span></p><ul><li><span>Web UIs need to query a local HTTP service acting as a wallet. This setup is meant to be temporary and for testing only: in the future, web UIs will securely connect to a Wallet installed as a browser extension, as usual.</span></li><li><span>Only user chains are currently available for testing and documented in this manual. Support for other types of chain (called &quot;public&quot; and &quot;permissioned&quot;) will be added later.</span></li></ul><p><span>The main development workstreams of Linera, beyond its SDK, can be broken down as follows.</span></p><h3><a name="core-protocolhttpslineradevcoreconceptsoverviewhtmlcore-protocol" class="md-header-anchor"></a><a href='https://linera.dev/core_concepts/overview.html#core-protocol'><span>Core Protocol</span></a></h3><ul><li><span> User chains</span></li><li><span> Permissioned chain (core protocol only)</span></li><li><span> Cross-chain messages</span></li><li><span> Cross-chain pub/sub channels (initial version)</span></li><li><span> Bytecode publishing</span></li><li><span> Application creation</span></li><li><span> Reconfigurations of validators</span></li><li><span> Initial support for gas fees</span></li><li><span> Initial support for storage fees and storage limits</span></li><li><span> External services to help users create their first chain</span></li><li><span> Permissioned chains (adding operation access control, demo of atomic swaps, etc)</span></li><li><span> Public chains (adding leader election, inbox constraints, etc)</span></li><li><span> Support for easy onboarding of user chains into a new application (removing the need to accept requests)</span></li><li><span> Improved pub/sub channels (removing the need to accept subscriptions)</span></li><li><span> Blob storage for applications (generalizing bytecode storage)</span></li><li><span> Support for archiving chains</span></li><li><span> Wallet-friendly chain clients (compile to Wasm/JS, do not maintain execution states for other chains)</span></li><li><span> General tokenomics and incentives for all stakeholders</span></li><li><span> Governance on the admin chain (e.g. DPoS, onboarding of validators)</span></li><li><span> Auditing procedures</span></li></ul><h3><a name="wasm-vm-integrationhttpslineradevcoreconceptsoverviewhtmlwasm-vm-integration" class="md-header-anchor"></a><a href='https://linera.dev/core_concepts/overview.html#wasm-vm-integration'><span>Wasm VM integration</span></a></h3><ul><li><span> Support for the Wasmer VM</span></li><li><span> Support for the Wasmtime VM (experimental)</span></li><li><span> Test gas metering and deterministic execution across VMs</span></li><li><span> Composing Wasm applications on the same chain (initial version)</span></li><li><span> Enhanced composability with &quot;sessions&quot;</span></li><li><span> Support for non-blocking (yet deterministic) calls to storage</span></li><li><span> Support for read-only GraphQL services in Wasm</span></li><li><span> Support for mocked system APIs (initial version)</span></li><li><span> More efficient cross-application calls</span></li><li><span> Improve host/guest stub generation to make mocks easier (currently wit-bindgen)</span></li><li><span> Compile user full node to Wasm/JS</span></li></ul><h3><a name="storagehttpslineradevcoreconceptsoverviewhtmlstorage" class="md-header-anchor"></a><a href='https://linera.dev/core_concepts/overview.html#storage'><span>Storage</span></a></h3><ul><li><span> Object management library (&quot;linera-views&quot;) on top of Key-Value store abstraction</span></li><li><span> Support for Rocksdb</span></li><li><span> Experimental support for DynamoDb</span></li><li><span> Initial derive macros for GraphQL</span></li><li><span> Initial support for ScyllaDb</span></li><li><span> Make library fully extensible by users (requires better GraphQL macros)</span></li><li><span> Performance benchmarks and improvements (including faster state hashing)</span></li><li><span> Production-grade support for the chosen main database</span></li><li><span> Support global object locks (needed for dynamic sharding)</span></li><li><span> Tooling for debugging</span></li><li><span> Make the storage library easy to use outside of Linera</span></li></ul><h3><a name="validator-infrastructurehttpslineradevcoreconceptsoverviewhtmlvalidator-infrastructure" class="md-header-anchor"></a><a href='https://linera.dev/core_concepts/overview.html#validator-infrastructure'><span>Validator Infrastructure</span></a></h3><ul><li><span> Simple TCP/UDP networking (used for benchmarks only)</span></li><li><span> GRPC networking</span></li><li><span> Basic frontend (aka. proxy) supporting fixed internal shards</span></li><li><span> Observability</span></li><li><span> Initial kubernetes support in CI</span></li><li><span> Initial deployment using a cloud provider</span></li><li><span> New frontend to support dynamic shard assignment</span></li><li><span> Cloud integration to demonstrate elastic scaling</span></li></ul><h3><a name="web3-sdkhttpslineradevcoreconceptsoverviewhtmlweb3-sdk" class="md-header-anchor"></a><a href='https://linera.dev/core_concepts/overview.html#web3-sdk'><span>Web3 SDK</span></a></h3><ul><li><span> Initial traits for contract and service interfaces</span></li><li><span> Support for unit testing</span></li><li><span> Support for integration testing</span></li><li><span> Local GraphQL service to query and browse system state</span></li><li><span> Local GraphQL service to query and browse application states</span></li><li><span> Use GraphQL mutations to execute operations and create blocks</span></li><li><span> Initial support for unit tests</span></li><li><span> Support for integration tests</span></li><li><span> Initial ABIs for contract and service interfaces</span></li><li><span> Allowing message sender to pay for message execution fees</span></li><li><span> Bindings to use native cryptographic primitives from Wasm</span></li><li><span> Allowing applications to pay for user fees</span></li><li><span> Allowing applications to use permissioned chains and public chains</span></li><li><span> Wallet as a browser extension (no VM)</span></li><li><span> Wallet as a browser extension (with Wasm VM)</span></li></ul><h1><a name="microchainshttpslineradevcoreconceptsmicrochainshtmlmicrochains" class="md-header-anchor"></a><a href='https://linera.dev/core_concepts/microchains.html#microchains'><span>Microchains</span></a></h1><p><span>This section provides an introduction to microchains, the main building block of the Linera Protocol. For a more formal treatment refer to the </span><a href='https://linera.io/whitepaper'><span>whitepaper</span></a><span>.</span></p><h2><a name="backgroundhttpslineradevcoreconceptsmicrochainshtmlbackground" class="md-header-anchor"></a><a href='https://linera.dev/core_concepts/microchains.html#background'><span>Background</span></a></h2><p><span>A </span><strong><span>microchain</span></strong><span> is a chain of blocks describing successive changes to a shared state. We will use the terms </span><em><span>chain</span></em><span> and </span><em><span>microchain</span></em><span> interchangeably. Linera microchains are similar to the familiar notion of blockchain, with the following important specificities:</span></p><ul><li><span>An arbitrary number of microchains can coexist in a Linera network, all sharing the same set of validators and the same level of security. Creating a new microchain only takes one transaction on an existing chain.</span></li><li><span>The task of proposing new blocks in a microchain can be assumed either by validators or by end users (or rather their wallets) depending on the configuration of a chain. Specifically, microchains can be </span><em><span>single-owner</span></em><span>, </span><em><span>permissioned</span></em><span>, or </span><em><span>public</span></em><span>, depending on who is authorized to propose blocks.</span></li></ul><h2><a name="cross-chain-messaginghttpslineradevcoreconceptsmicrochainshtmlcross-chain-messaging" class="md-header-anchor"></a><a href='https://linera.dev/core_concepts/microchains.html#cross-chain-messaging'><span>Cross-Chain Messaging</span></a></h2><p><span>In traditional networks with a single blockchain, every transaction can access the entire execution state. This is not the case in Linera where the state of a microchain is only affected by its own blocks.</span></p><p><span>Cross-chain messaging is a way for different microchains to communicate with each other asynchronously. This method allows applications and data to be distributed across multiple chains for better scalability. When an application on one chain sends a message to another chain, a cross-chain request is created. These requests are implemented using remote procedure calls (RPCs) within the validators&#39; internal network, ensuring that each request is executed only once.</span></p><p><span>Instead of immediately modifying the target chain, messages are placed first in the target chain&#39;s </span><strong><span>inbox</span></strong><span>. When an owner of the target chain creates its next block in the future, they may reference a selection of messages taken from the current inbox in the new block. This executes the selected messages and applies their messages to the chain state.</span></p><p><span>Below is an example set of chains sending asynchronous messages to each other over consecutive blocks.</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="ignore" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="ignore"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ┌───┐ &nbsp; &nbsp; ┌───┐ &nbsp; &nbsp; ┌───┐</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Chain A │ &nbsp; ├────►│ &nbsp; ├────►│ &nbsp; │</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; └───┘ &nbsp; &nbsp; └───┘ &nbsp; &nbsp; └───┘</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ▲</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ┌─────────┘</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; │</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ┌───┐ &nbsp; &nbsp; ┌─┴─┐ &nbsp; &nbsp; ┌───┐</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Chain B │ &nbsp; ├────►│ &nbsp; ├────►│ &nbsp; │</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; └───┘ &nbsp; &nbsp; └─┬─┘ &nbsp; &nbsp; └───┘</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; │ &nbsp; &nbsp; &nbsp; &nbsp; ▲</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; │ &nbsp; &nbsp; &nbsp; &nbsp; │</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ▼ &nbsp; &nbsp; &nbsp; &nbsp; │</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ┌───┐ &nbsp; &nbsp; ┌───┐ &nbsp; &nbsp; ┌─┴─┐</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Chain C │ &nbsp; ├────►│ &nbsp; ├────►│ &nbsp; │</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; └───┘ &nbsp; &nbsp; └───┘ &nbsp; &nbsp; └───┘</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 345px;"></div><div class="CodeMirror-gutters" style="display: none; height: 345px;"></div></div></div></pre><p><span>The Linera protocol allows receivers to discard messages but not to change the ordering of selected messages inside the communication queue between two chains. If a selected message fails to execute, it is skipped during the execution of the receiver&#39;s block. The current implementation of the Linera client always selects as many messages as possible from inboxes, and never discards messages.</span></p><h2><a name="chain-ownership-semanticshttpslineradevcoreconceptsmicrochainshtmlchain-ownership-semantics" class="md-header-anchor"></a><a href='https://linera.dev/core_concepts/microchains.html#chain-ownership-semantics'><span>Chain Ownership Semantics</span></a></h2><p><span>Only single-owner chains are currently supported in the Linera SDK. However, microchains can create new microchains for other users, and control of a chain can be transferred to another user by changing the owner id. A chain is permanently deactivated when its owner id is set to </span><code>None</code><span>.</span></p><p><span>For more detail and examples on how to open and close chains, see the wallet section on </span><a href='https://linera.dev/core_concepts/wallets.html#opening-a-chain'><span>chain management</span></a><span>.</span></p><h1><a name="walletshttpslineradevcoreconceptswalletshtmlwallets" class="md-header-anchor"></a><a href='https://linera.dev/core_concepts/wallets.html#wallets'><span>Wallets</span></a></h1><p><span>As in traditional blockchains, Linera wallets are in charge of holding user private keys. However, instead of signing transactions, Linera wallets are meant to sign blocks and propose them to extend the chains owned by their users.</span></p><p><span>In practice, wallets include a node which tracks a subset of Linera chains. We will see in the </span><a href='https://linera.dev/core_concepts/node_service.html'><span>next section</span></a><span> how a Linera wallet can run a GraphQL service to expose the state of its chains to web frontends.</span></p><blockquote><p><span>The command-line tool </span><code>linera</code><span> is the main way for developers to interact with a Linera network and manage the user wallets present locally on the system.</span></p></blockquote><p><span>Note that this command-line tool is intended mainly for development purposes. Our goal is that end users eventually manage their wallets in a </span><a href='https://linera.dev/core_concepts/overview.html#web3-sdk'><span>browser extension</span></a><span>.</span></p><h2><a name="selecting-a-wallethttpslineradevcoreconceptswalletshtmlselecting-a-wallet" class="md-header-anchor"></a><a href='https://linera.dev/core_concepts/wallets.html#selecting-a-wallet'><span>Selecting a Wallet</span></a></h2><p><span>The private state of a wallet is conventionally stored in a file </span><code>wallet.json</code><span>, while the state of its node is stored in a file </span><code>linera.db</code><span>.</span></p><p><span>To switch between wallets, you may use the </span><code>--wallet</code><span> and </span><code>--storage</code><span> options of the </span><code>linera</code><span> tool, e.g. as in </span><code>linera --wallet wallet2.json --storage rocksdb:linera2.db</code><span>.</span></p><p><span>You may also define the environment variables </span><code>LINERA_STORAGE</code><span> and </span><code>LINERA_WALLET</code><span> to the same effect. E.g. </span><code>LINERA_STORAGE=$PWD/wallet2.json</code><span> and </span><code>LINERA_WALLET=$PWD/wallet2.json</code><span>.</span></p><p><span>Finally, if </span><code>LINERA_STORAGE_$I</code><span> and </span><code>LINERA_WALLET_$I</code><span> are defined for some number </span><code>I</code><span>, you may call </span><code>linera --with-wallet $I</code><span> (or </span><code>linera -w $I</code><span> for short).</span></p><h2><a name="chain-managementhttpslineradevcoreconceptswalletshtmlchain-management" class="md-header-anchor"></a><a href='https://linera.dev/core_concepts/wallets.html#chain-management'><span>Chain Management</span></a></h2><h3><a name="listing-chainshttpslineradevcoreconceptswalletshtmllisting-chains" class="md-header-anchor"></a><a href='https://linera.dev/core_concepts/wallets.html#listing-chains'><span>Listing Chains</span></a></h3><p><span>To list the chains present in your wallet, you may use the command </span><code>show</code><span>:</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="bash" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">linera wallet show</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">╭──────────────────────────────────────────────────────────────────┬──────────────────────────────────────────────────────────────────────────────────────╮</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">│ Chain Id &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ┆ Latest Block &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; │</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">╞══════════════════════════════════════════════════════════════════╪══════════════════════════════════════════════════════════════════════════════════════╡</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">│ 668774d6f49d0426f610ad0bfa22d2a06f5f5b7b5c045b84a26286ba6bce93b4 ┆ Public Key: &nbsp; &nbsp; &nbsp; &nbsp; 3812c2bf764e905a3b130a754e7709fe2fc725c0ee346cb15d6d261e4f30b8f1 │</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">│ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ┆ Owner: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  c9a538585667076981abfe99902bac9f4be93714854281b652d07bb6d444cb76 │</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">│ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ┆ Block Hash: &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-attribute">-</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  │</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">│ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ┆ Timestamp: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">2023</span><span class="cm-attribute">-04-10</span> <span class="cm-number">13</span>:52:20.820840 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; │</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">│ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ┆ Next Block Height: &nbsp;<span class="cm-number">0</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  │</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┤</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">│ 91c7b394ef500cd000e365807b770d5b76a6e8c9c2f2af8e58c205e521b5f646 ┆ Public Key: &nbsp; &nbsp; &nbsp; &nbsp; 29c19718a26cb0d5c1d28102a2836442f53e3184f33b619ff653447280ccba1a │</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">│ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ┆ Owner: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  efe0f66451f2f15c33a409dfecdf76941cf1e215c5482d632c84a2573a1474e8 │</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">│ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ┆ Block Hash: &nbsp; &nbsp; &nbsp; &nbsp; 51605cad3f6a210183ac99f7f6ef507d0870d0c3a3858058034cfc0e3e541c13 │</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">│ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ┆ Timestamp: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">2023</span><span class="cm-attribute">-04-10</span> <span class="cm-number">13</span>:52:21.885221 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; │</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">│ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ┆ Next Block Height: &nbsp;<span class="cm-number">1</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  │</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">╰──────────────────────────────────────────────────────────────────┴──────────────────────────────────────────────────────────────────────────────────────╯</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 713px;"></div><div class="CodeMirror-gutters" style="display: none; height: 713px;"></div></div></div></pre><p><span>Each row represents a chain present in the wallet. On the left is the unique identifier on the chain, and on the right is metadata for that chain associated with the latest block.</span></p><h3><a name="default-chainhttpslineradevcoreconceptswalletshtmldefault-chain" class="md-header-anchor"></a><a href='https://linera.dev/core_concepts/wallets.html#default-chain'><span>Default Chain</span></a></h3><p><span>Each wallet has a default chain that all commands apply to unless you specify another </span><code>--chain</code><span> on the command line.</span></p><p><span>The default chain is set initially, when the first chain is added to the wallet. You can check the default chain for your wallet by running:</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="bash"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">linera wallet show</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 23px;"></div><div class="CodeMirror-gutters" style="display: none; height: 23px;"></div></div></div></pre><p><span>The Chain Id which is in green text instead of white text is your default chain.</span></p><p><span>To change the default chain for your wallet, user the </span><code>set-default</code><span> command:</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="bash"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">linera wallet set-default &lt;chain-id&gt;</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 23px;"></div><div class="CodeMirror-gutters" style="display: none; height: 23px;"></div></div></div></pre><h3><a name="opening-a-chainhttpslineradevcoreconceptswalletshtmlopening-a-chain" class="md-header-anchor"></a><a href='https://linera.dev/core_concepts/wallets.html#opening-a-chain'><span>Opening a Chain</span></a></h3><p><span>The Linera protocol defines semantics for how new chains are created, we call this &quot;opening a chain&quot;. A chain cannot be opened in a vacuum, it needs to be created by an existing chain on the network.</span></p><h4><a name="open-a-chain-for-your-own-wallethttpslineradevcoreconceptswalletshtmlopen-a-chain-for-your-own-wallet" class="md-header-anchor"></a><a href='https://linera.dev/core_concepts/wallets.html#open-a-chain-for-your-own-wallet'><span>Open a Chain for Your Own Wallet</span></a></h4><p><span>To open a chain for your own wallet, you can use the </span><code>open-chain</code><span> command:</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="bash"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">linera open-chain</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 23px;"></div><div class="CodeMirror-gutters" style="display: none; height: 23px;"></div></div></div></pre><p><span>This will create a new chain (using the wallet&#39;s default chain) and add it to the wallet. Use the </span><code>wallet show</code><span> command to see your existing chains.</span></p><h4><a name="open-a-chain-for-another-wallethttpslineradevcoreconceptswalletshtmlopen-a-chain-for-another-wallet" class="md-header-anchor"></a><a href='https://linera.dev/core_concepts/wallets.html#open-a-chain-for-another-wallet'><span>Open a Chain for Another Wallet</span></a></h4><p><span>Opening a chain for another </span><code>wallet</code><span> requires an extra two steps. Let&#39;s initialize a second wallet:</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="bash"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">linera <span class="cm-attribute">--wallet</span> wallet2.json <span class="cm-attribute">--storage</span> rocksdb:linera2.db wallet init <span class="cm-attribute">--genesis</span> target/debug/genesis.json</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 23px;"></div><div class="CodeMirror-gutters" style="display: none; height: 23px;"></div></div></div></pre><p><span>First </span><code>wallet2</code><span> must create an unassigned keypair. The public part of that keypair is then sent to the </span><code>wallet</code><span> who is the chain creator.</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="bash"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">linera <span class="cm-attribute">--wallet</span> wallet2.json keygen</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">6443634d872afbbfcc3059ac87992c4029fa88e8feb0fff0723ac6c914088888 <span class="cm-comment"># this is the public key for the unassigned keypair</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 46px;"></div><div class="CodeMirror-gutters" style="display: none; height: 46px;"></div></div></div></pre><p><span>Next, using the public key, </span><code>wallet</code><span> can open a chain for </span><code>wallet2</code><span>.</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="bash"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">linera open-chain <span class="cm-attribute">--to-public-key</span> 6443634d872afbbfcc3059ac87992c4029fa88e8feb0fff0723ac6c914088888</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">e476187f6ddfeb9d588c7b45d3df334d5501d6499b3f9ad5595cae86cce16a65010000000000000000000000</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">fc9384defb0bcd8f6e206ffda32599e24ba715f45ec88d4ac81ec47eb84fa111</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 69px;"></div><div class="CodeMirror-gutters" style="display: none; height: 69px;"></div></div></div></pre><p><span>The first line is the message ID specifying the cross-chain message that creates the new chain. of the newly created chain. The second line is the new chain&#39;s ID.</span></p><p><span>Finally, to add the chain to </span><code>wallet2</code><span> for the given unassigned key we use the </span><code>assign</code><span> command:</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="bash"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> linera <span class="cm-attribute">--wallet</span> wallet2.json assign <span class="cm-attribute">--key</span> 6443634d872afbbfcc3059ac87992c4029fa88e8feb0fff0723ac6c914088888 <span class="cm-attribute">--message-id</span> e476187f6ddfeb9d588c7b45d3df334d5501d6499b3f9ad5595cae86cce16a65010000000000000000000000</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 46px;"></div><div class="CodeMirror-gutters" style="display: none; height: 46px;"></div></div></div></pre><h2><a name="setting-up-extra-wallets-automatically-with-linera-net-uphttpslineradevcoreconceptswalletshtmlsetting-up-extra-wallets-automatically-with-linera-net-up" class="md-header-anchor"></a><a href='https://linera.dev/core_concepts/wallets.html#setting-up-extra-wallets-automatically-with-linera-net-up'><span>Setting up Extra Wallets Automatically with </span><code>linera net up</code></a></h2><p><span>For testing, rather than using </span><code>linera open-chain</code><span> and </span><code>linera assign</code><span> as above, it is often more convenient to pass the option </span><code>--extra-wallets N</code><span> to </span><code>linera net up</code><span>.</span></p><p><span>This option will create create </span><code>N</code><span> additional user wallets and output Bash commands to define the environment variables </span><code>LINERA_{WALLET,STORAGE}_$I</code><span> where </span><code>I</code><span> ranges over </span><code>0..=N</code><span> (</span><code>I=0</code><span> being the wallet for the initial chains).</span></p><p><span>Once all the environment variables are defined, you may switch between wallets using </span><code>linera --with-wallet I</code><span> or </span><code>linera -w I</code><span> for short.</span></p><h2><a name="automation-in-bashhttpslineradevcoreconceptswalletshtmlautomation-in-bash" class="md-header-anchor"></a><a href='https://linera.dev/core_concepts/wallets.html#automation-in-bash'><span>Automation in Bash</span></a></h2><p><span>To automate the process of setting the variables </span><code>LINERA_WALLET*</code><span> and </span><code>LINERA_STORAGE*</code><span> after creating a local test network in a shell, we provide a Bash helper function </span><code>linera_spawn_and_read_wallet_variables</code><span>.</span></p><p><span>To define the function </span><code>linera_spawn_and_read_wallet_variables</code><span> in your shell, run </span><code>source /dev/stdin &lt;&lt;&lt;&quot;$(linera net helper 2&gt;/dev/null)&quot;</code><span>. You may also add the output of </span><code>linera net helper</code><span> to your </span><code>~/.bash_profile</code><span> for future sessions.</span></p><p><span>Once the function is defined, call </span><code>linera_spawn_and_read_wallet_variables linera net up</code><span> instead of </span><code>linera net up</code><span>.</span></p><h1><a name="node-servicehttpslineradevcoreconceptsnodeservicehtmlnode-service" class="md-header-anchor"></a><a href='https://linera.dev/core_concepts/node_service.html#node-service'><span>Node Service</span></a></h1><p><span>So far we&#39;ve seen how to use the Linera client treating it as a binary in your terminal. However, the client also acts as a node which:</span></p><ol><li><span>Executes blocks</span></li><li><span>Exposes an GraphQL API and IDE for dynamically interacting with applications and the system</span></li><li><span>Listens for notifications from validators and automatically updates local chains.</span></li></ol><p><span>To interact with the node service, run </span><code>linera</code><span> in </span><code>service</code><span> mode:</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="bash"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">linera <span class="cm-builtin">service</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 23px;"></div><div class="CodeMirror-gutters" style="display: none; height: 23px;"></div></div></div></pre><p><span>This will run the node service on port 8080 by default (this can be overridden using the </span><code>--port</code><span> flag).</span></p><h2><a name="a-note-on-graphqlhttpslineradevcoreconceptsnodeservicehtmla-note-on-graphql" class="md-header-anchor"></a><a href='https://linera.dev/core_concepts/node_service.html#a-note-on-graphql'><span>A Note on GraphQL</span></a></h2><p><span>Linera uses GraphQL as the query language for interfacing with different parts of the system. GraphQL enables clients to craft queries such that they receive exactly what they want and nothing more.</span></p><p><span>GraphQL is used extensively during application development, especially to query the state of an application from a front-end for example.</span></p><p><span>To learn more about GraphQL check out the </span><a href='https://graphql.org/learn/'><span>official docs</span></a><span>.</span></p><h2><a name="graphiql-idehttpslineradevcoreconceptsnodeservicehtmlgraphiql-ide" class="md-header-anchor"></a><a href='https://linera.dev/core_concepts/node_service.html#graphiql-ide'><span>GraphiQL IDE</span></a></h2><p><span>Conveniently, the node service exposes a GraphQL IDE called GraphiQL. To use GraphiQL start the node service and navigate to </span><code>localhost:8080/</code><span>.</span></p><p><span>Using the schema explorer on the left of the GraphiQL IDE you can dynamically explore the state of the system and your applications.</span></p><p><img src="https://linera.dev/core_concepts/graphiql.png" referrerpolicy="no-referrer" alt="graphiql.png"></p><h2><a name="graphql-system-apihttpslineradevcoreconceptsnodeservicehtmlgraphql-system-api" class="md-header-anchor"></a><a href='https://linera.dev/core_concepts/node_service.html#graphql-system-api'><span>GraphQL System API</span></a></h2><p><span>The node service also exposes a GraphQL API which corresponds to the set of system operations. You can explore the full set of operations by clicking on </span><code>MutationRoot</code><span>.</span></p><h2><a name="graphql-application-apihttpslineradevcoreconceptsnodeservicehtmlgraphql-application-api" class="md-header-anchor"></a><a href='https://linera.dev/core_concepts/node_service.html#graphql-application-api'><span>GraphQL Application API</span></a></h2><p><span>To interact with an application, we run the Linera client in service mode. It exposes a GraphQL API for every application running on any owned chain at </span><code>localhost:8080/chains/&lt;chain-id&gt;/applications/&lt;application-id&gt;</code><span>.</span></p><p><span>Navigating there with your browser will open a GraphiQL interface which enables you to graphically explore the state of your application.</span></p><h1><a name="applicationshttpslineradevcoreconceptsapplicationshtmlapplications" class="md-header-anchor"></a><a href='https://linera.dev/core_concepts/applications.html#applications'><span>Applications</span></a></h1><p><span>The programming model of Linera is designed so that developers can take advantage of microchains to scale their applications.</span></p><p><span>Linera uses the WebAssembly Virtual Machine (Wasm) to execute user applications. Currently, the </span><a href='https://linera.dev/sdk.html'><span>Linera SDK</span></a><span> is focused on the </span><a href='https://www.rust-lang.org/'><span>Rust</span></a><span> programming language.</span></p><p><span>Linera applications are structured using the familiar notion of </span><strong><span>Rust crate</span></strong><span>: the external interfaces of an application (including initialization parameters, operations, messages, and cross-application calls) generally go into the library part of its crate, while the core of each application is compiled into binary files for the Wasm architecture.</span></p><h2><a name="the-application-deployment-lifecyclehttpslineradevcoreconceptsapplicationshtmlthe-application-deployment-lifecycle" class="md-header-anchor"></a><a href='https://linera.dev/core_concepts/applications.html#the-application-deployment-lifecycle'><span>The Application Deployment Lifecycle</span></a></h2><p><span>Linera Applications are designed to be powerful yet re-usable. For this reason there is a distinction between the bytecode and an application instance on the network.</span></p><p><span>Applications undergo a lifecycle transition aimed at making development easy and flexible:</span></p><ol><li><span>The bytecode is built from a Rust project with the </span><code>linera-sdk</code><span> dependency.</span></li><li><span>The bytecode is published to the network on a microchain, and assigned an identifier.</span></li><li><span>A user can create a new application instance, by providing the bytecode identifier and initialization arguments. This process returns an application identifier which can be used to reference and interact with the application.</span></li><li><span>The same bytecode identifier can be used as many times is needed by as many users are needed to create distinct applications.</span></li></ol><p><span>Importantly, the application deployment lifecycle is abstracted from the user, and an application can be published with a single command:</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="bash"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">linera publish-and-create &lt;contract-path&gt; &lt;service-path&gt; &lt;init-args&gt;</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 23px;"></div><div class="CodeMirror-gutters" style="display: none; height: 23px;"></div></div></div></pre><p><span>This will publish the bytecode as well as initialize the application for you.</span></p><h2><a name="anatomy-of-an-applicationhttpslineradevcoreconceptsapplicationshtmlanatomy-of-an-application" class="md-header-anchor"></a><a href='https://linera.dev/core_concepts/applications.html#anatomy-of-an-application'><span>Anatomy of an Application</span></a></h2><p><span>An </span><strong><span>application</span></strong><span> is broken into two major components, the </span><em><span>contract</span></em><span> and the </span><em><span>service</span></em><span>.</span></p><p><span>The </span><strong><span>contract</span></strong><span> is gas-metered, and is the part of the application which executes operations and messages, make cross-application calls and modifies the application&#39;s state. The details are covered in more depth in the </span><a href='https://linera.dev/sdk.html'><span>SDK docs</span></a><span>.</span></p><p><span>The </span><strong><span>service</span></strong><span> is non-metered and read-only. It is used primarily to query the state of an application and populate the presentation layer (think front-end) with the data required for a user interface.</span></p><p><span>Finally, the application&#39;s state is shared by the contract and service in the form of a </span><a href='https://linera.dev/advanced_topics/views.html'><span>View</span></a><span>, but more on that later.</span></p><h2><a name="operations-and-messageshttpslineradevcoreconceptsapplicationshtmloperations-and-messages" class="md-header-anchor"></a><a href='https://linera.dev/core_concepts/applications.html#operations-and-messages'><span>Operations and Messages</span></a></h2><blockquote><p><span>For this section we&#39;ll be using a simplified version of the example application called &quot;fungible&quot; where users can send tokens to each other.</span></p></blockquote><p><span>At the system-level, interacting with an application can be done via operations and messages.</span></p><p><strong><span>Operations</span></strong><span> are defined by an application developer and each application can have a completely different set of operations. Chain owners then actively create operations and put them in their block proposals to interact with an application.</span></p><p><span>Taking the &quot;fungible token&quot; application as an example, an operation for a user to transfer funds to another user would look like this:</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="rust"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="rust"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-meta">#[derive(Debug, Deserialize, Serialize)]</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">pub</span> <span class="cm-keyword">enum</span> <span class="cm-def">Operation</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">/// A transfer from a (locally owned) account to a (possibly remote) account.</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">Transfer</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">owner</span>: <span class="cm-variable">AccountOwner</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">amount</span>: <span class="cm-variable">Amount</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">target_account</span>: <span class="cm-variable">Account</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  },</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">// Meant to be extended here</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 230px;"></div><div class="CodeMirror-gutters" style="display: none; height: 230px;"></div></div></div></pre><p><strong><span>Messages</span></strong><span> result from the execution of operations or other messages. Messages can be sent from one chain to another. Block proposers also actively include messages in their block proposal, but unlike with operations, they are only allowed to include them in the right order (possibly skipping some), and only if they were actually created by another chain (or the same chain, earlier).</span></p><p><span>In our &quot;fungible token&quot; application, a message to credit an account would look like this:</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="rust"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="rust"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-meta">#[derive(Debug, Deserialize, Serialize)]</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">pub</span> <span class="cm-keyword">enum</span> <span class="cm-def">Message</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">Credit</span> { <span class="cm-variable">owner</span>: <span class="cm-variable">AccountOwner</span>, <span class="cm-variable">amount</span>: <span class="cm-variable">Amount</span> },</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">// Meant to be extended here</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 115px;"></div><div class="CodeMirror-gutters" style="display: none; height: 115px;"></div></div></div></pre><h3><a name="authenticationhttpslineradevcoreconceptsapplicationshtmlauthentication" class="md-header-anchor"></a><a href='https://linera.dev/core_concepts/applications.html#authentication'><span>Authentication</span></a></h3><p><span>Operations are always authenticated and messages may be authenticated. The signer of a block becomes the authenticator of all the operations in that block. As operations are executed by applications, messages can be created to be sent to other chains. When they are created, they can be configured to be authenticated. In that case, the message receives the same authentication as the operation that created it. If handling an incoming message creates new messages, those may also be configured to have the same authentication as the received message.</span></p><p><span>In other words, the block signer can have its authority propagated across chains through series of messages. This allows applications to safely store user state in chains that the user may not have the authority to produce blocks. The application may also allow only the authorized user to change that state, and not even the chain owner is able to override that.</span></p><p><span>The figure below shows four chains (A, B, C, D) and some blocks produced in them. In this example, each chain is owned by a single owner (aka. address). Owners are in charge of producing blocks and sign new blocks using their signing keys. Some blocks show the operations and incoming messages they accept, where the authentication is shown inside parenthesis. All operations produced are authenticated by the block proposer, and if these are all single user chains, the proposer is always the chain owner. Messages that have authentication use the one from the operation or message that created it.</span></p><p><span>One example in the figure is that chain A produced a block with Operation 1, which is authenticated by the owner of chain A (written </span><code>(a)</code><span>). That operations sent a message to chain B, and assuming the message was sent with the authentication forwarding enabled, it is received and executed in chain B with the authentication of </span><code>(a)</code><span>. Another example is that chain D produced a block with Operation 2, which is authenticated by the owner of chain D (written </span><code>(d)</code><span>). That operation sent a message to chain C, which is executed with authentication of </span><code>(d)</code><span> like the example before. Handling that message in chain C produced a new message, which was sent to chain B. That message, when received by chain B is executed with the authentication of </span><code>(d)</code><span>.</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="ignore" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="ignore"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ┌───┐ &nbsp; &nbsp; ┌─────────────────┐ &nbsp; &nbsp; ┌───┐</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; Chain A owned by (a) │ &nbsp; ├────►│ Operation 1 (a) ├────►│ &nbsp; │</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  └───┘ &nbsp; &nbsp; └────────┬────────┘ &nbsp; &nbsp; └───┘</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; │</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; └────────────┐</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ▼</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ┌──────────────────────────┐</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ┌───┐ &nbsp; &nbsp; ┌───┐ &nbsp; &nbsp; │ Message from chain A (a) │</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; Chain B owned by (b) │ &nbsp; ├────►│ &nbsp; ├────►│ Message from chain C (d) |</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  └───┘ &nbsp; &nbsp; └───┘ &nbsp; &nbsp; │ Operation 3 (b) &nbsp; &nbsp; &nbsp; &nbsp;  │</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  └──────────────────────────┘</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ▲</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ┌────────┘</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; │</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ┌───┐ &nbsp; &nbsp; ┌──────────────────────────┐ &nbsp; &nbsp; ┌───┐</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; Chain C owned by (c) │ &nbsp; ├────►│ Message from chain D (d) ├────►│ &nbsp; │</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  └───┘ &nbsp; &nbsp; └──────────────────────────┘ &nbsp; &nbsp; └───┘</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ▲</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ┌───────────┘</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; │</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ┌─────────────────┐ &nbsp; &nbsp; ┌───┐ &nbsp; &nbsp; ┌───┐</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; Chain D owned by (d) │ Operation 2 (d) ├────►│ &nbsp; ├────►│ &nbsp; │</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  └─────────────────┘ &nbsp; &nbsp; └───┘ &nbsp; &nbsp; └───┘</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 529px;"></div><div class="CodeMirror-gutters" style="display: none; height: 529px;"></div></div></div></pre><p><span>An example where this is used is in the Fungible application, where a </span><code>Claim</code><span> operation allows retrieving money from a chain the user does not control (but the user still trusts will produce a block receiving their message). Without the </span><code>Claim</code><span> operation, users would only be able to store their tokens on their own chains, and multi-owner and public chains would have their tokens shared between anyone able to produce a block.</span></p><p><span>With the </span><code>Claim</code><span> operation, users can store their tokens on another chain where they&#39;re able to produce blocks or where they trust the owner will produce blocks receiving their messages. Only they are able to move their tokens, even on chains where ownership is shared or where they are not able to produce blocks.</span></p><h2><a name="registering-an-application-across-chainshttpslineradevcoreconceptsapplicationshtmlregistering-an-application-across-chains" class="md-header-anchor"></a><a href='https://linera.dev/core_concepts/applications.html#registering-an-application-across-chains'><span>Registering an Application across Chains</span></a></h2><p><span>If Alice is using an application on her chain and starts interacting with Bob via the application, e.g. sends him some tokens using the </span><code>fungible</code><span> example, the application automatically gets registered on Bob&#39;s chain, too, as soon as he handles the incoming cross-chain messages. After that, he can execute the application&#39;s operations on his chain, too, and e.g. send tokens to someone.</span></p><p><span>But there are also cases where Bob may want to start using an application he doesn&#39;t have yet. E.g. maybe Alice regularly makes posts using the </span><code>social</code><span> example, and Bob wants to subscribe to her.</span></p><p><span>In that case, trying to execute an application-specific operation would fail, because the application is not registered on his chain. He needs to request it from Alice first:</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="bash"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">linera request-application &lt;application-id&gt; <span class="cm-attribute">--target-chain-id</span> &lt;alices-chain-id&gt;</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 23px;"></div><div class="CodeMirror-gutters" style="display: none; height: 23px;"></div></div></div></pre><p><span>Once Alice processes his message (which happens automatically if she is running the client in service mode), he can start using the application.</span></p><h1><a name="writing-linera-applicationshttpslineradevsdkhtmlwriting-linera-applications" class="md-header-anchor"></a><a href='https://linera.dev/sdk.html#writing-linera-applications'><span>Writing Linera Applications</span></a></h1><p><span>In this section, we&#39;ll be exploring how to create Web3 applications using the Linera SDK.</span></p><p><span>We&#39;ll use a simple &quot;counter&quot; application as a running example.</span></p><p><span>We&#39;ll focus on the back end of the application, which consists of two main parts: a </span><em><span>smart contract</span></em><span> and its GraphQL service.</span></p><p><span>Both the contract and the service of an application are written in Rust using the crate </span><a href='https://crates.io/crates/linera-sdk'><code>linera-sdk</code></a><span>, and compiled to Wasm bytecode.</span></p><p><span>This section should be seen as a guide versus a reference manual for the SDK. For the reference manual, refer to the </span><a href='https://docs.rs/linera-sdk/latest/linera_sdk/'><span>documentation of the crate</span></a><span>.</span></p><h1><a name="creating-a-linera-projecthttpslineradevsdkcreatingaprojecthtmlcreating-a-linera-project" class="md-header-anchor"></a><a href='https://linera.dev/sdk/creating_a_project.html#creating-a-linera-project'><span>Creating a Linera Project</span></a></h1><p><span>To create your Linera project, use the </span><code>linera project new</code><span> command. The command should be executed outside the </span><code>linera-protocol</code><span> folder. It sets up the scaffolding and requisite files:</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="bash"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">linera project new my-counter</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 23px;"></div><div class="CodeMirror-gutters" style="display: none; height: 23px;"></div></div></div></pre><p><code>linera project new</code><span> bootstraps your project by creating the following key files:</span></p><ul><li><code>Cargo.toml</code><span>: your project&#39;s manifest filled with the necessary dependencies to create an app;</span></li><li><code>src/lib.rs</code><span>: the application&#39;s ABI definition;</span></li><li><code>src/state.rs</code><span>: the application&#39;s state;</span></li><li><code>src/contract.rs</code><span>: the application&#39;s contract, and the binary target for the contract bytecode;</span></li><li><code>src/service.rs</code><span>: the application&#39;s service, and the binary target for the service bytecode.</span></li><li><code>.cargo/config.toml</code><span>: modifies the default target used by </span><code>cargo</code><span> to be </span><code>wasm32-unknown-unknown</code></li></ul><h1><a name="creating-the-application-statehttpslineradevsdkstatehtmlcreating-the-application-state" class="md-header-anchor"></a><a href='https://linera.dev/sdk/state.html#creating-the-application-state'><span>Creating the Application State</span></a></h1><p><span>The </span><code>struct</code><span> which defines your application&#39;s state can be found in </span><code>src/state.rs</code><span>.</span></p><p><span>To represent our counter, we&#39;re going to need a single </span><code>u64</code><span>. To persist the counter we&#39;ll be using Linera&#39;s </span><a href='https://linera.dev/advanced_topics/views.html'><span>view</span></a><span> paradigm.</span></p><p><span>Views are a little like an </span><a href='https://en.wikipedia.org/wiki/Object–relational_mapping'><span>ORM</span></a><span>, however instead of mapping data structures to a relational database like Postgres, they are instead mapped onto key-value stores like </span><a href='https://rocksdb.org/'><span>RocksDB</span></a><span>.</span></p><p><span>In vanilla Rust, we might represent our Counter as so:</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="rust"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="rust"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">// do not use this</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">struct</span> <span class="cm-def">Counter</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">value</span>: <span class="cm-atom">u64</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 92px;"></div><div class="CodeMirror-gutters" style="display: none; height: 92px;"></div></div></div></pre><p><span>However, to persist your data, you&#39;ll need to replace the existing </span><code>Application</code><span> state struct in </span><code>src/state.rs</code><span> with the following view:</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="rust"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="rust"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">/// The application state.</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-meta">#[derive(RootView, async_graphql::SimpleObject)]</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-meta">#[view(context = "ViewStorageContext")]</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">pub</span> <span class="cm-keyword">struct</span> <span class="cm-def">Counter</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">pub</span> <span class="cm-variable">value</span>: <span class="cm-variable">RegisterView</span><span class="cm-operator">&lt;</span><span class="cm-atom">u64</span><span class="cm-operator">&gt;</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 138px;"></div><div class="CodeMirror-gutters" style="display: none; height: 138px;"></div></div></div></pre><p><span>and all other occurrences of </span><code>Application</code><span> in your app.</span></p><p><span>The </span><code>RegisterView&lt;T&gt;</code><span> supports modifying a single value of type </span><code>T</code><span>. There are different types of views for different use-cases, but the majority of common data structures have already been implemented:</span></p><ul><li><span>A </span><code>Vec</code><span> or </span><code>VecDeque</code><span> corresponds to a </span><code>LogView</code></li><li><span>A </span><code>BTreeMap</code><span> corresponds to a </span><code>MapView</code><span> if its values are primitive, or to </span><code>CollectionView</code><span> if its values are other views;</span></li><li><span>A </span><code>Queue</code><span> corresponds to a </span><code>QueueView</code></li></ul><p><span>For an exhaustive list refer to the Views </span><a href='https://linera.dev/advanced_topics/views.html'><span>documentation</span></a><span>.</span></p><p><span>Finally, run </span><code>cargo check</code><span> to ensure that your changes compile.</span></p><h1><a name="defining-the-abihttpslineradevsdkabihtmldefining-the-abi" class="md-header-anchor"></a><a href='https://linera.dev/sdk/abi.html#defining-the-abi'><span>Defining the ABI</span></a></h1><p><span>The Application Binary Interface (ABI) of a Linera application defines how to interact with this application from other parts of the system. It includes the data structures, data types, and functions exposed by on-chain contracts and services.</span></p><p><span>ABIs are usually defined in </span><code>src/lib.rs</code><span> and compiled across all architectures (Wasm and native).</span></p><p><span>For a reference guide, check out the </span><a href='https://docs.rs/linera-base/latest/linera_base/abi/'><span>documentation of the crate</span></a><span>.</span></p><h2><a name="defining-a-marker-structhttpslineradevsdkabihtmldefining-a-marker-struct" class="md-header-anchor"></a><a href='https://linera.dev/sdk/abi.html#defining-a-marker-struct'><span>Defining a marker struct</span></a></h2><p><span>The library part of your application (generally in </span><code>src/lib.rs</code><span>) must define a public empty struct that implements the </span><code>Abi</code><span> trait.</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="rust"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="rust"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">struct</span> <span class="cm-def">CounterAbi</span>;</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 23px;"></div><div class="CodeMirror-gutters" style="display: none; height: 23px;"></div></div></div></pre><p><span>The </span><code>Abi</code><span> trait combines the </span><code>ContractAbi</code><span> and </span><code>ServiceAbi</code><span> traits to include the types that your application exports.</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="rust"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="rust"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">/// A trait that includes all the types exported by a Linera application (both contract</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">/// and service).</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">pub</span> <span class="cm-keyword">trait</span> <span class="cm-variable">Abi</span>: <span class="cm-variable">ContractAbi</span> <span class="cm-operator">+</span> <span class="cm-variable">ServiceAbi</span> {}</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 69px;"></div><div class="CodeMirror-gutters" style="display: none; height: 69px;"></div></div></div></pre><p><span>Next, we&#39;re going to implement each of the two traits.</span></p><h2><a name="contract-abihttpslineradevsdkabihtmlcontract-abi" class="md-header-anchor"></a><a href='https://linera.dev/sdk/abi.html#contract-abi'><span>Contract ABI</span></a></h2><p><span>The </span><code>ContractAbi</code><span> trait defines the data types that your application uses in a contract. Each type represents a specific part of the contract&#39;s behavior:</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="rust" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="rust"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">/// A trait that includes all the types exported by a Linera application contract.</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">pub</span> <span class="cm-keyword">trait</span> <span class="cm-variable">ContractAbi</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">/// Immutable parameters specific to this application (e.g. the name of a token).</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">type</span> <span class="cm-def">Parameters</span>: <span class="cm-variable">Serialize</span> <span class="cm-operator">+</span> <span class="cm-variable">DeserializeOwned</span> <span class="cm-operator">+</span> <span class="cm-variable">Send</span> <span class="cm-operator">+</span> <span class="cm-variable">Sync</span> <span class="cm-operator">+</span> <span class="cm-variable">Debug</span> <span class="cm-operator">+</span> '<span class="cm-keyword">static</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">/// Initialization argument passed to a new application on the chain that created it</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">/// (e.g. an initial amount of tokens minted).</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">///</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">/// To share configuration data on every chain, use [`ContractAbi::Parameters`]</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">/// instead.</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">type</span> <span class="cm-def">InitializationArgument</span>: <span class="cm-variable">Serialize</span> <span class="cm-operator">+</span> <span class="cm-variable">DeserializeOwned</span> <span class="cm-operator">+</span> <span class="cm-variable">Send</span> <span class="cm-operator">+</span> <span class="cm-variable">Sync</span> <span class="cm-operator">+</span> <span class="cm-variable">Debug</span> <span class="cm-operator">+</span> '<span class="cm-keyword">static</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">/// The type of operation executed by the application.</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">///</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">/// Operations are transactions directly added to a block by the creator (and signer)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">/// of the block. Users typically use operations to start interacting with an</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">/// application on their own chain.</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">type</span> <span class="cm-def">Operation</span>: <span class="cm-variable">Serialize</span> <span class="cm-operator">+</span> <span class="cm-variable">DeserializeOwned</span> <span class="cm-operator">+</span> <span class="cm-variable">Send</span> <span class="cm-operator">+</span> <span class="cm-variable">Sync</span> <span class="cm-operator">+</span> <span class="cm-variable">Debug</span> <span class="cm-operator">+</span> '<span class="cm-keyword">static</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">/// The type of message executed by the application.</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">///</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">/// Messages are executed when a message created by the same application is received</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">/// from another chain and accepted in a block.</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">type</span> <span class="cm-def">Message</span>: <span class="cm-variable">Serialize</span> <span class="cm-operator">+</span> <span class="cm-variable">DeserializeOwned</span> <span class="cm-operator">+</span> <span class="cm-variable">Send</span> <span class="cm-operator">+</span> <span class="cm-variable">Sync</span> <span class="cm-operator">+</span> <span class="cm-variable">Debug</span> <span class="cm-operator">+</span> '<span class="cm-keyword">static</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">/// The argument type when this application is called from another application on the same chain.</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">type</span> <span class="cm-def">ApplicationCall</span>: <span class="cm-variable">Serialize</span> <span class="cm-operator">+</span> <span class="cm-variable">DeserializeOwned</span> <span class="cm-operator">+</span> <span class="cm-variable">Send</span> <span class="cm-operator">+</span> <span class="cm-variable">Sync</span> <span class="cm-operator">+</span> <span class="cm-variable">Debug</span> <span class="cm-operator">+</span> '<span class="cm-keyword">static</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">/// The argument type when a session of this application is called from another</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">/// application on the same chain.</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">///</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">/// Sessions are temporary objects that may be spawned by an application call. Once</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">/// created, they must be consumed before the current transaction ends.</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">type</span> <span class="cm-def">SessionCall</span>: <span class="cm-variable">Serialize</span> <span class="cm-operator">+</span> <span class="cm-variable">DeserializeOwned</span> <span class="cm-operator">+</span> <span class="cm-variable">Send</span> <span class="cm-operator">+</span> <span class="cm-variable">Sync</span> <span class="cm-operator">+</span> <span class="cm-variable">Debug</span> <span class="cm-operator">+</span> '<span class="cm-keyword">static</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">/// The type for the state of a session.</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">type</span> <span class="cm-def">SessionState</span>: <span class="cm-variable">Serialize</span> <span class="cm-operator">+</span> <span class="cm-variable">DeserializeOwned</span> <span class="cm-operator">+</span> <span class="cm-variable">Send</span> <span class="cm-operator">+</span> <span class="cm-variable">Sync</span> <span class="cm-operator">+</span> <span class="cm-variable">Debug</span> <span class="cm-operator">+</span> '<span class="cm-keyword">static</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">/// The response type of an application call.</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">type</span> <span class="cm-def">Response</span>: <span class="cm-variable">Serialize</span> <span class="cm-operator">+</span> <span class="cm-variable">DeserializeOwned</span> <span class="cm-operator">+</span> <span class="cm-variable">Send</span> <span class="cm-operator">+</span> <span class="cm-variable">Sync</span> <span class="cm-operator">+</span> <span class="cm-variable">Debug</span> <span class="cm-operator">+</span> '<span class="cm-keyword">static</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 943px;"></div><div class="CodeMirror-gutters" style="display: none; height: 943px;"></div></div></div></pre><p><span>All these types must implement the </span><code>Serialize</code><span>, </span><code>DeserializeOwned</code><span>, </span><code>Send</code><span>, </span><code>Sync</code><span>, </span><code>Debug</code><span> traits, and have a </span><code>&#39;static</code><span> lifetime.</span></p><p><span>In our example, we would like to change our </span><code>InitializationArgument</code><span>, </span><code>Operation</code><span> to </span><code>u64</code><span>, like so:</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="rust"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="rust"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">impl</span> <span class="cm-variable">ContractAbi</span> <span class="cm-keyword">for</span> <span class="cm-variable">CounterAbi</span> {</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">type</span> <span class="cm-def">InitializationArgument</span> <span class="cm-operator">=</span> <span class="cm-atom">u64</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">type</span> <span class="cm-def">Parameters</span> <span class="cm-operator">=</span> ();</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">type</span> <span class="cm-def">Operation</span> <span class="cm-operator">=</span> <span class="cm-atom">u64</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">type</span> <span class="cm-def">ApplicationCall</span> <span class="cm-operator">=</span> ();</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">type</span> <span class="cm-def">Message</span> <span class="cm-operator">=</span> ();</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">type</span> <span class="cm-def">SessionCall</span> <span class="cm-operator">=</span> ();</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">type</span> <span class="cm-def">Response</span> <span class="cm-operator">=</span> ();</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">type</span> <span class="cm-def">SessionState</span> <span class="cm-operator">=</span> ();</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 230px;"></div><div class="CodeMirror-gutters" style="display: none; height: 230px;"></div></div></div></pre><h2><a name="service-abihttpslineradevsdkabihtmlservice-abi" class="md-header-anchor"></a><a href='https://linera.dev/sdk/abi.html#service-abi'><span>Service ABI</span></a></h2><p><span>The </span><code>ServiceAbi</code><span> is in principle very similar to the </span><code>ContractAbi</code><span>, just for the service component of your application.</span></p><p><span>The </span><code>ServiceAbi</code><span> trait defines the types used by the service part of your application:</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="rust"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="rust"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><span><span>​</span>x</span></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">/// A trait that includes all the types exported by a Linera application service.</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">pub</span> <span class="cm-keyword">trait</span> <span class="cm-variable">ServiceAbi</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">/// Immutable parameters specific to this application (e.g. the name of a token).</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">type</span> <span class="cm-def">Parameters</span>: <span class="cm-variable">Serialize</span> <span class="cm-operator">+</span> <span class="cm-variable">DeserializeOwned</span> <span class="cm-operator">+</span> <span class="cm-variable">Send</span> <span class="cm-operator">+</span> <span class="cm-variable">Sync</span> <span class="cm-operator">+</span> <span class="cm-variable">Debug</span> <span class="cm-operator">+</span> '<span class="cm-keyword">static</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">/// The type of a query receivable by the application's service.</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">type</span> <span class="cm-def">Query</span>: <span class="cm-variable">Serialize</span> <span class="cm-operator">+</span> <span class="cm-variable">DeserializeOwned</span> <span class="cm-operator">+</span> <span class="cm-variable">Send</span> <span class="cm-operator">+</span> <span class="cm-variable">Sync</span> <span class="cm-operator">+</span> <span class="cm-variable">Debug</span> <span class="cm-operator">+</span> '<span class="cm-keyword">static</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">/// The response type of the application's service.</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">type</span> <span class="cm-def">QueryResponse</span>: <span class="cm-variable">Serialize</span> <span class="cm-operator">+</span> <span class="cm-variable">DeserializeOwned</span> <span class="cm-operator">+</span> <span class="cm-variable">Send</span> <span class="cm-operator">+</span> <span class="cm-variable">Sync</span> <span class="cm-operator">+</span> <span class="cm-variable">Debug</span> <span class="cm-operator">+</span> '<span class="cm-keyword">static</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 253px;"></div><div class="CodeMirror-gutters" style="display: none; height: 253px;"></div></div></div></pre><p><span>For our Counter example, we&#39;ll be using GraphQL to query our application so our </span><code>ServiceAbi</code><span> should reflect that:</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="rust"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="rust"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">impl</span> <span class="cm-variable">ServiceAbi</span> <span class="cm-keyword">for</span> <span class="cm-variable">CounterAbi</span> {</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">type</span> <span class="cm-def">Query</span> <span class="cm-operator">=</span> <span class="cm-variable">async_graphql</span>::<span class="cm-variable">Request</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">type</span> <span class="cm-def">QueryResponse</span> <span class="cm-operator">=</span> <span class="cm-variable">async_graphql</span>::<span class="cm-variable">Response</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">type</span> <span class="cm-def">Parameters</span> <span class="cm-operator">=</span> ();</span></pre><div class="" style="position: relative;"><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 115px;"></div><div class="CodeMirror-gutters" style="display: none; height: 115px;"></div></div></div></pre><h1><a name="writing-the-contract-binaryhttpslineradevsdkcontracthtmlwriting-the-contract-binary" class="md-header-anchor"></a><a href='https://linera.dev/sdk/contract.html#writing-the-contract-binary'><span>Writing the Contract Binary</span></a></h1><p><span>The contract binary is the first component of a Linera application. It can actually change the state of the application.</span></p><p><span>To create a contract, we need to implement the </span><code>Contract</code><span> trait, which is as follows:</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="rust" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="rust"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-meta">#[async_trait]</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">pub</span> <span class="cm-keyword">trait</span> <span class="cm-variable">Contract</span>: <span class="cm-variable">WithContractAbi</span> <span class="cm-operator">+</span> <span class="cm-variable">ContractAbi</span> <span class="cm-operator">+</span> <span class="cm-variable">Send</span> <span class="cm-operator">+</span> <span class="cm-variable">Sized</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">/// The type used to report errors to the execution environment.</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">type</span> <span class="cm-def">Error</span>: <span class="cm-variable">Error</span> <span class="cm-operator">+</span> <span class="cm-variable">From</span><span class="cm-operator">&lt;</span><span class="cm-variable">serde_json</span>::<span class="cm-variable">Error</span><span class="cm-operator">&gt;</span> <span class="cm-operator">+</span> <span class="cm-variable">From</span><span class="cm-operator">&lt;</span><span class="cm-variable">bcs</span>::<span class="cm-variable">Error</span><span class="cm-operator">&gt;</span> <span class="cm-operator">+</span> '<span class="cm-keyword">static</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">/// The desired storage backend used to store the application's state.</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">type</span> <span class="cm-def">Storage</span>: <span class="cm-variable">ContractStateStorage</span><span class="cm-operator">&lt;</span><span class="cm-atom">Self</span><span class="cm-operator">&gt;</span> <span class="cm-operator">+</span> <span class="cm-variable">Send</span> <span class="cm-operator">+</span> '<span class="cm-keyword">static</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">/// Initializes the application on the chain that created it.</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">async</span> <span class="cm-keyword">fn</span> <span class="cm-def">initialize</span>(</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  &amp;<span class="cm-variable">mut</span> <span class="cm-keyword">self</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">context</span>: &amp;<span class="cm-variable">OperationContext</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">argument</span>: <span class="cm-atom">Self</span>::<span class="cm-variable">InitializationArgument</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  ) <span class="cm-operator">-&gt;</span> <span class="cm-variable">Result</span><span class="cm-operator">&lt;</span><span class="cm-variable">ExecutionOutcome</span><span class="cm-operator">&lt;</span><span class="cm-atom">Self</span>::<span class="cm-variable">Message</span><span class="cm-operator">&gt;</span>, <span class="cm-atom">Self</span>::<span class="cm-variable">Error</span><span class="cm-operator">&gt;</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">/// Applies an operation from the current block.</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">async</span> <span class="cm-keyword">fn</span> <span class="cm-def">execute_operation</span>(</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  &amp;<span class="cm-variable">mut</span> <span class="cm-keyword">self</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">context</span>: &amp;<span class="cm-variable">OperationContext</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">operation</span>: <span class="cm-atom">Self</span>::<span class="cm-variable">Operation</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  ) <span class="cm-operator">-&gt;</span> <span class="cm-variable">Result</span><span class="cm-operator">&lt;</span><span class="cm-variable">ExecutionOutcome</span><span class="cm-operator">&lt;</span><span class="cm-atom">Self</span>::<span class="cm-variable">Message</span><span class="cm-operator">&gt;</span>, <span class="cm-atom">Self</span>::<span class="cm-variable">Error</span><span class="cm-operator">&gt;</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">/// Applies a message originating from a cross-chain message.</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">async</span> <span class="cm-keyword">fn</span> <span class="cm-def">execute_message</span>(</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  &amp;<span class="cm-variable">mut</span> <span class="cm-keyword">self</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">context</span>: &amp;<span class="cm-variable">MessageContext</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">message</span>: <span class="cm-atom">Self</span>::<span class="cm-variable">Message</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  ) <span class="cm-operator">-&gt;</span> <span class="cm-variable">Result</span><span class="cm-operator">&lt;</span><span class="cm-variable">ExecutionOutcome</span><span class="cm-operator">&lt;</span><span class="cm-atom">Self</span>::<span class="cm-variable">Message</span><span class="cm-operator">&gt;</span>, <span class="cm-atom">Self</span>::<span class="cm-variable">Error</span><span class="cm-operator">&gt;</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">/// Handles a call from another application.</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">async</span> <span class="cm-keyword">fn</span> <span class="cm-def">handle_application_call</span>(</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  &amp;<span class="cm-variable">mut</span> <span class="cm-keyword">self</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">context</span>: &amp;<span class="cm-variable">CalleeContext</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">argument</span>: <span class="cm-atom">Self</span>::<span class="cm-variable">ApplicationCall</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">forwarded_sessions</span>: <span class="cm-variable">Vec</span><span class="cm-operator">&lt;</span><span class="cm-variable">SessionId</span><span class="cm-operator">&gt;</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  ) <span class="cm-operator">-&gt;</span> <span class="cm-variable">Result</span><span class="cm-operator">&lt;</span><span class="cm-variable">ApplicationCallResult</span><span class="cm-operator">&lt;</span><span class="cm-atom">Self</span>::<span class="cm-variable">Message</span>, <span class="cm-atom">Self</span>::<span class="cm-variable">Response</span>, <span class="cm-atom">Self</span>::<span class="cm-variable">SessionState</span><span class="cm-operator">&gt;</span>, <span class="cm-atom">Self</span>::<span class="cm-variable">Error</span><span class="cm-operator">&gt;</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">/// Handles a call into a session created by this application.</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">async</span> <span class="cm-keyword">fn</span> <span class="cm-def">handle_session_call</span>(</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  &amp;<span class="cm-variable">mut</span> <span class="cm-keyword">self</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">context</span>: &amp;<span class="cm-variable">CalleeContext</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">session</span>: <span class="cm-atom">Self</span>::<span class="cm-variable">SessionState</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">argument</span>: <span class="cm-atom">Self</span>::<span class="cm-variable">SessionCall</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">forwarded_sessions</span>: <span class="cm-variable">Vec</span><span class="cm-operator">&lt;</span><span class="cm-variable">SessionId</span><span class="cm-operator">&gt;</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  ) <span class="cm-operator">-&gt;</span> <span class="cm-variable">Result</span><span class="cm-operator">&lt;</span><span class="cm-variable">SessionCallResult</span><span class="cm-operator">&lt;</span><span class="cm-atom">Self</span>::<span class="cm-variable">Message</span>, <span class="cm-atom">Self</span>::<span class="cm-variable">Response</span>, <span class="cm-atom">Self</span>::<span class="cm-variable">SessionState</span><span class="cm-operator">&gt;</span>, <span class="cm-atom">Self</span>::<span class="cm-variable">Error</span><span class="cm-operator">&gt;</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 1081px;"></div><div class="CodeMirror-gutters" style="display: none; height: 1081px;"></div></div></div></pre><p><span>The full trait definition can be found </span><a href='https://github.com/linera-io/linera-protocol/blob/main/linera-sdk/src/lib.rs'><span>here</span></a><span>.</span></p><p><span>There&#39;s quite a bit going on here, so let&#39;s break it down and take one method at a time.</span></p><p><span>For this application, we&#39;ll be using the </span><code>initialize</code><span> and </span><code>execute_operation</code><span> methods.</span></p><h2><a name="initializing-our-applicationhttpslineradevsdkcontracthtmlinitializing-our-application" class="md-header-anchor"></a><a href='https://linera.dev/sdk/contract.html#initializing-our-application'><span>Initializing our Application</span></a></h2><p><span>The first thing we need to do is initialize our application by using </span><code>Contract::initialize</code><span>.</span></p><p><code>Contract::initialize</code><span> is only called once when the application is created and only on the microchain that created the application.</span></p><p><span>Deployment on other microchains will use the </span><code>Default</code><span> implementation of the application state if </span><code>SimpleStateStorage</code><span> is used, or the </span><code>Default</code><span> value of all sub-views in the state if the </span><code>ViewStateStorage</code><span> is used.</span></p><p><span>For our example application, we&#39;ll want to initialize the state of the application to an arbitrary number that can be specified on application creation using its initialization parameters:</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="rust"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="rust"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">async</span> <span class="cm-keyword">fn</span> <span class="cm-def">initialize</span>(</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  &amp;<span class="cm-variable">mut</span> <span class="cm-keyword">self</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">_context</span>: &amp;<span class="cm-variable">OperationContext</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">value</span>: <span class="cm-atom">u64</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  ) <span class="cm-operator">-&gt;</span> <span class="cm-variable">Result</span><span class="cm-operator">&lt;</span><span class="cm-variable">ExecutionOutcome</span><span class="cm-operator">&lt;</span><span class="cm-atom">Self</span>::<span class="cm-variable">Message</span><span class="cm-operator">&gt;</span>, <span class="cm-atom">Self</span>::<span class="cm-variable">Error</span><span class="cm-operator">&gt;</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">self</span>.<span class="cm-variable">value</span>.<span class="cm-variable">set</span>(<span class="cm-variable">value</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-builtin">Ok</span>(<span class="cm-variable">ExecutionOutcome</span>::<span class="cm-variable">default</span>())</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  }</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 184px;"></div><div class="CodeMirror-gutters" style="display: none; height: 184px;"></div></div></div></pre><h2><a name="implementing-the-increment-operationhttpslineradevsdkcontracthtmlimplementing-the-increment-operation" class="md-header-anchor"></a><a href='https://linera.dev/sdk/contract.html#implementing-the-increment-operation'><span>Implementing the Increment Operation</span></a></h2><p><span>Now that we have our counter&#39;s state and a way to initialize it to any value we would like, a way to increment our counter&#39;s value. Changes made by block proposers to application states are broadly called &#39;operations&#39;.</span></p><p><span>To create a new operation, we need to use the method </span><code>Contract::execute_operation</code><span>. In the counter&#39;s case, it will be receiving a </span><code>u64</code><span> which is used to increment the counter:</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="rust"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="rust"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">async</span> <span class="cm-keyword">fn</span> <span class="cm-def">execute_operation</span>(</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  &amp;<span class="cm-variable">mut</span> <span class="cm-keyword">self</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">_context</span>: &amp;<span class="cm-variable">OperationContext</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">operation</span>: <span class="cm-atom">u64</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  ) <span class="cm-operator">-&gt;</span> <span class="cm-variable">Result</span><span class="cm-operator">&lt;</span><span class="cm-variable">ExecutionOutcome</span><span class="cm-operator">&lt;</span><span class="cm-atom">Self</span>::<span class="cm-variable">Message</span><span class="cm-operator">&gt;</span>, <span class="cm-atom">Self</span>::<span class="cm-variable">Error</span><span class="cm-operator">&gt;</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">let</span> <span class="cm-def">current</span> <span class="cm-operator">=</span> <span class="cm-keyword">self</span>.<span class="cm-variable">value</span>.<span class="cm-variable">get</span>();</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">self</span>.<span class="cm-variable">value</span>.<span class="cm-variable">set</span>(<span class="cm-variable">current</span> <span class="cm-operator">+</span> <span class="cm-variable">operation</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-builtin">Ok</span>(<span class="cm-variable">ExecutionOutcome</span>::<span class="cm-variable">default</span>())</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  }</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 207px;"></div><div class="CodeMirror-gutters" style="display: none; height: 207px;"></div></div></div></pre><h2><a name="declaring-the-abihttpslineradevsdkcontracthtmldeclaring-the-abi" class="md-header-anchor"></a><a href='https://linera.dev/sdk/contract.html#declaring-the-abi'><span>Declaring the ABI</span></a></h2><p><span>Finally, to link our </span><code>Contract</code><span> trait implementation with the ABI of the application, the following code is added:</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="rust"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="rust"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">impl</span> <span class="cm-variable">WithContractAbi</span> <span class="cm-keyword">for</span> <span class="cm-variable">Counter</span> {</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">type</span> <span class="cm-def">Abi</span> <span class="cm-operator">=</span> <span class="cm-variable">counter</span>::<span class="cm-variable">CounterAbi</span>;</span></pre><div class="" style="position: relative;"><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 69px;"></div><div class="CodeMirror-gutters" style="display: none; height: 69px;"></div></div></div></pre><h1><a name="writing-the-service-binaryhttpslineradevsdkservicehtmlwriting-the-service-binary" class="md-header-anchor"></a><a href='https://linera.dev/sdk/service.html#writing-the-service-binary'><span>Writing the Service Binary</span></a></h1><p><span>The service binary is the second component of a Linera application. It is compiled into a separate Bytecode from the contract and is run independently. It is not metered (meaning that querying an application&#39;s service does not consume gas), and can be thought of as a read-only view into your application.</span></p><p><span>Application states can be arbitrarily complex, and most of the time you don&#39;t want to expose this state in its entirety to those who would like to interact with your app. Instead, you might prefer to define a distinct set of queries that can be made against your application.</span></p><p><span>The </span><code>Service</code><span> trait is how you define the interface into your application. The </span><code>Service</code><span> trait is defined as follows:</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="rust" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="rust"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">/// The service interface of a Linera application.</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-meta">#[async_trait]</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">pub</span> <span class="cm-keyword">trait</span> <span class="cm-variable">Service</span>: <span class="cm-variable">WithServiceAbi</span> <span class="cm-operator">+</span> <span class="cm-variable">ServiceAbi</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">/// Type used to report errors to the execution environment.</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">type</span> <span class="cm-def">Error</span>: <span class="cm-variable">Error</span> <span class="cm-operator">+</span> <span class="cm-variable">From</span><span class="cm-operator">&lt;</span><span class="cm-variable">serde_json</span>::<span class="cm-variable">Error</span><span class="cm-operator">&gt;</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">/// The desired storage backend used to store the application's state.</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">type</span> <span class="cm-def">Storage</span>: <span class="cm-variable">ServiceStateStorage</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">/// Executes a read-only query on the state of this application.</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">async</span> <span class="cm-keyword">fn</span> <span class="cm-def">handle_query</span>(</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">self</span>: <span class="cm-variable">Arc</span><span class="cm-operator">&lt;</span><span class="cm-atom">Self</span><span class="cm-operator">&gt;</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">context</span>: &amp;<span class="cm-variable">QueryContext</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">argument</span>: <span class="cm-atom">Self</span>::<span class="cm-variable">Query</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  ) <span class="cm-operator">-&gt;</span> <span class="cm-variable">Result</span><span class="cm-operator">&lt;</span><span class="cm-atom">Self</span>::<span class="cm-variable">QueryResponse</span>, <span class="cm-atom">Self</span>::<span class="cm-variable">Error</span><span class="cm-operator">&gt;</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 368px;"></div><div class="CodeMirror-gutters" style="display: none; height: 368px;"></div></div></div></pre><p><span>The full service trait definition can be found </span><a href='https://github.com/linera-io/linera-protocol/blob/main/linera-sdk/src/lib.rs'><span>here</span></a><span>.</span></p><p><span>Let&#39;s implement </span><code>Service</code><span> for our counter application.</span></p><p><span>First, we want to generate the necessary boilerplate for implementing the service </span><a href='https://component-model.bytecodealliance.org/design/wit.html'><span>WIT interface</span></a><span>, export the necessary resource types and functions so that the host (the process running the bytecode) can call the service. Happily, there is a macro to perform this code generation, so just add the following to </span><code>service.rs</code><span>:</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="rust"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="rust"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">linera_sdk</span>::<span class="cm-variable-3">service!</span>(<span class="cm-variable">Counter</span>);</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 23px;"></div><div class="CodeMirror-gutters" style="display: none; height: 23px;"></div></div></div></pre><p><span>Next, we need to implement the </span><code>Service</code><span> for </span><code>Counter</code><span>. To do this we need to define </span><code>Service</code><span>&#39;s associated types and implement </span><code>handle_query</code><span>, as well as define the </span><code>Error</code><span> type:</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="rust" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="rust"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-meta">#[async_trait]</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">impl</span> <span class="cm-variable">Service</span> <span class="cm-keyword">for</span> <span class="cm-variable">Counter</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">type</span> <span class="cm-def">Error</span> <span class="cm-operator">=</span> <span class="cm-variable">Error</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">type</span> <span class="cm-def">Storage</span> <span class="cm-operator">=</span> <span class="cm-variable">ViewStateStorage</span><span class="cm-operator">&lt;</span><span class="cm-atom">Self</span><span class="cm-operator">&gt;</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">async</span> <span class="cm-keyword">fn</span> <span class="cm-def">handle_query</span>(</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">self</span>: <span class="cm-variable">Arc</span><span class="cm-operator">&lt;</span><span class="cm-atom">Self</span><span class="cm-operator">&gt;</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">_context</span>: &amp;<span class="cm-variable">QueryContext</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">request</span>: <span class="cm-variable">Request</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  ) <span class="cm-operator">-&gt;</span> <span class="cm-variable">Result</span><span class="cm-operator">&lt;</span><span class="cm-variable">Response</span>, <span class="cm-atom">Self</span>::<span class="cm-variable">Error</span><span class="cm-operator">&gt;</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">let</span> <span class="cm-def">schema</span> <span class="cm-operator">=</span> <span class="cm-variable">Schema</span>::<span class="cm-variable">build</span>(</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-comment">// implemented in the next section</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">QueryRoot</span> { <span class="cm-variable">value</span>: <span class="cm-operator">*</span><span class="cm-keyword">self</span>.<span class="cm-variable">value</span>.<span class="cm-variable">get</span>() },</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-comment">// implemented in the next section</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">MutationRoot</span> {},</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">EmptySubscription</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  )</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  .<span class="cm-variable">finish</span>();</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-builtin">Ok</span>(<span class="cm-variable">schema</span>.<span class="cm-variable">execute</span>(<span class="cm-variable">request</span>).<span class="cm-variable">await</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">/// An error that can occur during the contract execution.</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-meta">#[derive(Debug, Error)]</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">pub</span> <span class="cm-keyword">enum</span> <span class="cm-def">Error</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">/// Invalid query argument; could not deserialize GraphQL request.</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-meta">#[error("Invalid query argument; could not deserialize GraphQL request")]</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">InvalidQuery</span>(<span class="cm-meta">#[from]</span> <span class="cm-variable">serde_json</span>::<span class="cm-variable">Error</span>),</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 667px;"></div><div class="CodeMirror-gutters" style="display: none; height: 667px;"></div></div></div></pre><p><span>Finally, as before, the following code is needed to incorporate the ABI definitions into your </span><code>Service</code><span> implementation:</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="rust"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="rust"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">impl</span> <span class="cm-variable">WithServiceAbi</span> <span class="cm-keyword">for</span> <span class="cm-variable">Counter</span> {</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">type</span> <span class="cm-def">Abi</span> <span class="cm-operator">=</span> <span class="cm-variable">counter</span>::<span class="cm-variable">CounterAbi</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 69px;"></div><div class="CodeMirror-gutters" style="display: none; height: 69px;"></div></div></div></pre><h2><a name="adding-graphql-compatibilityhttpslineradevsdkservicehtmladding-graphql-compatibility" class="md-header-anchor"></a><a href='https://linera.dev/sdk/service.html#adding-graphql-compatibility'><span>Adding GraphQL compatibility</span></a></h2><p><span>Finally, we want our application to have GraphQL compatibility. To achieve this we need a </span><code>QueryRoot</code><span> for intercepting queries and a </span><code>MutationRoot</code><span> for introspection queries for mutations.</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="rust" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="rust"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">struct</span> <span class="cm-def">MutationRoot</span>;</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-meta">#[Object]</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">impl</span> <span class="cm-variable">MutationRoot</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">async</span> <span class="cm-keyword">fn</span> <span class="cm-def">increment</span>(&amp;<span class="cm-keyword">self</span>, <span class="cm-variable">value</span>: <span class="cm-atom">u64</span>) <span class="cm-operator">-&gt;</span> <span class="cm-variable">Vec</span><span class="cm-operator">&lt;</span><span class="cm-atom">u8</span><span class="cm-operator">&gt;</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">bcs</span>::<span class="cm-variable">to_bytes</span>(&amp;<span class="cm-variable">value</span>).<span class="cm-variable">unwrap</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">struct</span> <span class="cm-def">QueryRoot</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">value</span>: <span class="cm-atom">u64</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-meta">#[Object]</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">impl</span> <span class="cm-variable">QueryRoot</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">async</span> <span class="cm-keyword">fn</span> <span class="cm-def">value</span>(&amp;<span class="cm-keyword">self</span>) <span class="cm-operator">-&gt;</span> &amp;<span class="cm-atom">u64</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  &amp;<span class="cm-keyword">self</span>.<span class="cm-variable">value</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 437px;"></div><div class="CodeMirror-gutters" style="display: none; height: 437px;"></div></div></div></pre><p><span>We haven&#39;t included the imports in the above code; they are left as an exercise to the reader (but remember to import </span><code>async_graphql::Object</code><span>). If you want the full source code and associated tests check out the </span><a href='https://github.com/linera-io/linera-protocol/blob/main/examples/counter/src/service.rs'><span>examples section</span></a><span> on GitHub.</span></p><h1><a name="deploying-the-applicationhttpslineradevsdkdeployhtmldeploying-the-application" class="md-header-anchor"></a><a href='https://linera.dev/sdk/deploy.html#deploying-the-application'><span>Deploying the Application</span></a></h1><p><span>The first step to deploy your application is to configure a wallet. This will determine where the application will be deployed: either to a local net or to the devnet.</span></p><h2><a name="local-nethttpslineradevsdkdeployhtmllocal-net" class="md-header-anchor"></a><a href='https://linera.dev/sdk/deploy.html#local-net'><span>Local Net</span></a></h2><p><span>To configure the local network, follow the steps in the </span><a href='https://linera.dev/getting_started/hello_linera.html#using-the-initial-test-wallet'><span>Getting Started section</span></a><span>.</span></p><p><span>Afterwards, the </span><code>LINERA_WALLET</code><span> and the </span><code>LINERA_STORAGE</code><span> environment variables should be set and can be used in the </span><code>publish-and-create</code><span> command to deploy the application while also specifying:</span></p><ol><li><span>The location of the contract bytecode</span></li><li><span>The location of the service bytecode</span></li><li><span>The JSON encoded initialization arguments</span></li></ol><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="bash"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">linera publish-and-create \</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  target/wasm32-unknown-unknown/release/my-counter_{contract,service}.wasm \</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-attribute">--json-argument</span> <span class="cm-string">"42"</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 69px;"></div><div class="CodeMirror-gutters" style="display: none; height: 69px;"></div></div></div></pre><h2><a name="devnethttpslineradevsdkdeployhtmldevnet" class="md-header-anchor"></a><a href='https://linera.dev/sdk/deploy.html#devnet'><span>Devnet</span></a></h2><p><span>To configure the wallet for the devnet while creating a new microchain, the following command can be used:</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="bash"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">linera wallet init <span class="cm-attribute">--with-new-chain</span> <span class="cm-attribute">--faucet</span> https://faucet.devnet.linera.net</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 23px;"></div><div class="CodeMirror-gutters" style="display: none; height: 23px;"></div></div></div></pre><p><span>The Faucet will provide the new chain with some tokens, which can then be used to deploy the application with the </span><code>publish-and-create</code><span> command. It requires specifying:</span></p><ol><li><span>The location of the contract bytecode</span></li><li><span>The location of the service bytecode</span></li><li><span>The JSON encoded initialization arguments</span></li></ol><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="bash"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">linera publish-and-create \</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  target/wasm32-unknown-unknown/release/my-counter_{contract,service}.wasm \</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-attribute">--json-argument</span> <span class="cm-string">"42"</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 69px;"></div><div class="CodeMirror-gutters" style="display: none; height: 69px;"></div></div></div></pre><h2><a name="interacting-with-the-applicationhttpslineradevsdkdeployhtmlinteracting-with-the-application" class="md-header-anchor"></a><a href='https://linera.dev/sdk/deploy.html#interacting-with-the-application'><span>Interacting with the Application</span></a></h2><p><span>To interact with the deployed application, a </span><a href='https://linera.dev/core_concepts/node_service.html'><span>node service</span></a><span> must be used.</span></p><h1><a name="cross-chain-messageshttpslineradevsdkmessageshtmlcross-chain-messages" class="md-header-anchor"></a><a href='https://linera.dev/sdk/messages.html#cross-chain-messages'><span>Cross-Chain Messages</span></a></h1><p><span>On Linera, applications are meant to be multi-chain: They are instantiated on every chain where they are used. An application has the same application ID and bytecode everywhere, but a separate state on every chain. To coordinate, the instances can send </span><em><span>cross-chain messages</span></em><span> to each other. A message sent by an application is always handled by the </span><em><span>same</span></em><span> application on the target chain: The handling code is guaranteed to be the same as the sending code, but the state may be different.</span></p><p><span>For your application, you can specify any serializable type as the </span><code>Message</code><span> type in your </span><code>ContractAbi</code><span> implementation. To send a message, return it among the </span><a href='https://docs.rs/linera-sdk/latest/linera_sdk/struct.ExecutionOutcome.html'><code>ExecutionOutcome</code></a><span>&#39;s </span><code>messages</code><span>:</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="rust"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="rust"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">pub</span> <span class="cm-variable">messages</span>: <span class="cm-variable">Vec</span><span class="cm-operator">&lt;</span><span class="cm-variable">OutgoingMessage</span><span class="cm-operator">&lt;</span><span class="cm-variable">Message</span><span class="cm-operator">&gt;&gt;</span>,</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 23px;"></div><div class="CodeMirror-gutters" style="display: none; height: 23px;"></div></div></div></pre><p><code>OutgoingMessage</code><span>&#39;s </span><code>destination</code><span> field specifies either a single destination chain, or a channel, so that it gets sent to all subscribers.</span></p><p><span>If the </span><code>authenticated</code><span> field is </span><code>true</code><span>, the callee is allowed to perform actions that require authentication on behalf of the signer of the original block that caused this call.</span></p><p><span>The </span><code>message</code><span> field contains the message itself, of the type you specified in the </span><code>ContractAbi</code><span>.</span></p><p><span>You can also use </span><a href='https://docs.rs/linera-sdk/latest/linera_sdk/struct.ExecutionOutcome.html#method.with_message'><code>ExecutionOutcome::with_message</code></a><span> and </span><a href='https://docs.rs/linera-sdk/latest/linera_sdk/struct.ExecutionOutcome.html#method.with_authenticated_message'><code>with_authenticated_message</code></a><span> for convenience.</span></p><p><span>During block execution in the </span><em><span>sending</span></em><span> chain, messages are returned via </span><code>ExecutionOutcome</code><span>s. The returned message is then placed in the </span><em><span>target</span></em><span> chain inbox for processing. There is no guarantee that it will be handled: For this to happen, an owner of the target chain needs to include it in the </span><code>incoming_messages</code><span> in one of their blocks. When that happens, the contract&#39;s </span><code>execute_message</code><span> method gets called on their chain.</span></p><h2><a name="example-fungible-tokenhttpslineradevsdkmessageshtmlexample-fungible-token" class="md-header-anchor"></a><a href='https://linera.dev/sdk/messages.html#example-fungible-token'><span>Example: Fungible Token</span></a></h2><p><span>In the </span><a href='https://github.com/linera-io/linera-protocol/tree/main/examples/fungible'><code>fungible</code><span> example application</span></a><span>, such a message can be the transfer of tokens from one chain to another. If the sender includes a </span><code>Transfer</code><span> operation on their chain, it decreases their account balance and sends a </span><code>Credit</code><span> message to the recipient&#39;s chain:</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="rust" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="rust"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">async</span> <span class="cm-keyword">fn</span> <span class="cm-def">execute_operation</span>(</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  &amp;<span class="cm-variable">mut</span> <span class="cm-keyword">self</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">context</span>: &amp;<span class="cm-variable">OperationContext</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">operation</span>: <span class="cm-atom">Self</span>::<span class="cm-variable">Operation</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">) <span class="cm-operator">-&gt;</span> <span class="cm-variable">Result</span><span class="cm-operator">&lt;</span><span class="cm-variable">ExecutionOutcome</span><span class="cm-operator">&lt;</span><span class="cm-atom">Self</span>::<span class="cm-variable">Message</span><span class="cm-operator">&gt;</span>, <span class="cm-atom">Self</span>::<span class="cm-variable">Error</span><span class="cm-operator">&gt;</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">match</span> <span class="cm-variable">operation</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">Operation</span>::<span class="cm-variable">Transfer</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">owner</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">amount</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">target_account</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  } <span class="cm-operator">=&gt;</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-comment">// ...</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">self</span>.<span class="cm-variable">debit</span>(<span class="cm-variable">owner</span>, <span class="cm-variable">amount</span>).<span class="cm-variable">await</span>?;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">let</span> <span class="cm-def">message</span> <span class="cm-operator">=</span> <span class="cm-variable">Message</span>::<span class="cm-variable">Credit</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">owner</span>: <span class="cm-variable">target_account</span>.<span class="cm-variable">owner</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">amount</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  };</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-builtin">Ok</span>(<span class="cm-variable">ExecutionOutcome</span>::<span class="cm-variable">default</span>().<span class="cm-variable">with_message</span>(<span class="cm-variable">target_account</span>.<span class="cm-variable">chain_id</span>, <span class="cm-variable">message</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-comment">// ...</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 506px;"></div><div class="CodeMirror-gutters" style="display: none; height: 506px;"></div></div></div></pre><p><span>On the recipient&#39;s chain, </span><code>execute_message</code><span> is called, which increases their account balance.</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="rust"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="rust"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">async</span> <span class="cm-keyword">fn</span> <span class="cm-def">execute_message</span>(</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  &amp;<span class="cm-variable">mut</span> <span class="cm-keyword">self</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">context</span>: &amp;<span class="cm-variable">MessageContext</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">message</span>: <span class="cm-variable">Message</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">) <span class="cm-operator">-&gt;</span> <span class="cm-variable">Result</span><span class="cm-operator">&lt;</span><span class="cm-variable">ExecutionOutcome</span><span class="cm-operator">&lt;</span><span class="cm-atom">Self</span>::<span class="cm-variable">Message</span><span class="cm-operator">&gt;</span>, <span class="cm-atom">Self</span>::<span class="cm-variable">Error</span><span class="cm-operator">&gt;</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">match</span> <span class="cm-variable">message</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">Message</span>::<span class="cm-variable">Credit</span> { <span class="cm-variable">owner</span>, <span class="cm-variable">amount</span> } <span class="cm-operator">=&gt;</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">self</span>.<span class="cm-variable">credit</span>(<span class="cm-variable">owner</span>, <span class="cm-variable">amount</span>).<span class="cm-variable">await</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-builtin">Ok</span>(<span class="cm-variable">ExecutionOutcome</span>::<span class="cm-variable">default</span>())</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-comment">// ...</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  }</span></pre><div class="" style="position: relative;"><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 299px;"></div><div class="CodeMirror-gutters" style="display: none; height: 299px;"></div></div></div></pre><h1><a name="calling-other-applicationshttpslineradevsdkcompositionhtmlcalling-other-applications" class="md-header-anchor"></a><a href='https://linera.dev/sdk/composition.html#calling-other-applications'><span>Calling other Applications</span></a></h1><p><span>We have seen that cross-chain messages sent by an application on one chain are always handled by the </span><em><span>same</span></em><span> application on the target chain.</span></p><p><span>This section is about calling other applications using </span><em><span>cross-application calls</span></em><span>.</span></p><p><span>Such calls happen on the same chain and typically use the </span><code>call_application</code><span> method implemented by default in the trait </span><code>Contract</code><span>:</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="rust"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="rust"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">async</span> <span class="cm-keyword">fn</span> <span class="cm-def">call_application</span><span class="cm-operator">&lt;</span><span class="cm-variable">A</span>: <span class="cm-variable">ContractAbi</span> <span class="cm-operator">+</span> <span class="cm-variable">Send</span><span class="cm-operator">&gt;</span>(</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  &amp;<span class="cm-variable">mut</span> <span class="cm-keyword">self</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">authenticated</span>: <span class="cm-atom">bool</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">application</span>: <span class="cm-variable">ApplicationId</span><span class="cm-operator">&lt;</span><span class="cm-variable">A</span><span class="cm-operator">&gt;</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">call</span>: &amp;<span class="cm-variable">A</span>::<span class="cm-variable">ApplicationCall</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">forwarded_sessions</span>: <span class="cm-variable">Vec</span><span class="cm-operator">&lt;</span><span class="cm-variable">SessionId</span><span class="cm-operator">&gt;</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">) <span class="cm-operator">-&gt;</span> <span class="cm-variable">Result</span><span class="cm-operator">&lt;</span>(<span class="cm-variable">A</span>::<span class="cm-variable">Response</span>, <span class="cm-variable">Vec</span><span class="cm-operator">&lt;</span><span class="cm-variable">SessionId</span><span class="cm-operator">&gt;</span>), <span class="cm-atom">Self</span>::<span class="cm-variable">Error</span><span class="cm-operator">&gt;</span> { .. }</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 161px;"></div><div class="CodeMirror-gutters" style="display: none; height: 161px;"></div></div></div></pre><p><span>The </span><code>authenticated</code><span> argument specifies whether the callee is allowed to perform actions that require authentication on behalf of the signer of the original block that caused this call.</span></p><p><span>The </span><code>application</code><span> argument is the callee&#39;s application ID, and </span><code>A</code><span> is the callee&#39;s ABI.</span></p><p><code>call</code><span> are the arguments of the application call, in a type defined by the callee.</span></p><p><code>forwarded_sessions</code><span> are session data that need to be consumed within this transaction. Sessions will be explained in a separate section.</span></p><h2><a name="example-crowd-fundinghttpslineradevsdkcompositionhtmlexample-crowd-funding" class="md-header-anchor"></a><a href='https://linera.dev/sdk/composition.html#example-crowd-funding'><span>Example: Crowd-Funding</span></a></h2><p><span>The </span><code>crowd-funding</code><span> example application allows the application creator to launch a campaign with a funding target. That target can be an amount specified in any type of token based on the </span><code>fungible</code><span> application. Others can then pledge tokens of that type to the campaign, and if the target is not reached by the deadline, they are refunded.</span></p><p><span>If Alice used the </span><code>fungible</code><span> example to create a Pugecoin application (with an impressionable pug as its mascot), then Bob can create a </span><code>crowd-funding</code><span> application, use Pugecoin&#39;s application ID as </span><code>CrowdFundingAbi::Parameters</code><span>, and specify in </span><code>CrowdFundingAbi::InitializationArgument</code><span> that his campaign will run for one week and has a target of 1000 Pugecoins.</span></p><p><span>Now let&#39;s say Carol wants to pledge 10 Pugecoin tokens to Bob&#39;s campaign.</span></p><p><span>First she needs to make sure she has his crowd-funding application on her chain, e.g. using the </span><code>linera request-application</code><span> command. This will automatically also register Alice&#39;s application on her chain, because it is a dependency of Bob&#39;s.</span></p><p><span>Now she can make her pledge by running the </span><code>linera service</code><span> and making a query to Bob&#39;s application:</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="json"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="json"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">mutation</span> { <span class="cm-property">pledgeWithTransfer</span>(<span class="cm-def">owner</span>: <span class="cm-string">"User:841…6c0"</span>, <span class="cm-variable">amount</span>: <span class="cm-string">"10"</span>) }</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 23px;"></div><div class="CodeMirror-gutters" style="display: none; height: 23px;"></div></div></div></pre><p><span>This will add a block to Carol&#39;s chain containing the pledge operation that gets handled by </span><code>CrowdFunding::execute_operation</code><span>, resulting in one cross-application call and two cross-chain messages:</span></p><p><span>First </span><code>CrowdFunding::execute_operation</code><span> calls the </span><code>fungible</code><span> application on Carol&#39;s chain to transfer 10 tokens to Carol&#39;s account on Bob&#39;s chain:</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="rust"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="rust"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">self</span>.<span class="cm-variable">call_application</span>(</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-builtin">true</span>, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-comment">// The call is authenticated by Carol, who signed this block.</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-atom">Self</span>::<span class="cm-variable">fungible_id</span>()?, <span class="cm-comment">// The Pugecoin application ID.</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  &amp;<span class="cm-variable">fungible</span>::<span class="cm-variable">ApplicationCall</span>::<span class="cm-variable">Transfer</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">owner</span>, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-comment">// Carol</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">amount</span>, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-comment">// 10 tokens</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">destination</span>, &nbsp; &nbsp; &nbsp;<span class="cm-comment">// Bob's chain.</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  },</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">vec!</span>[],</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">).<span class="cm-variable">await</span>?;</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 230px;"></div><div class="CodeMirror-gutters" style="display: none; height: 230px;"></div></div></div></pre><p><span>This causes </span><code>Fungible::handle_application_call</code><span> to be run, which will create a cross-chain message sending the amount 10 to the Pugecoin application instance on Bob&#39;s chain.</span></p><p><span>After the cross-application call returns, </span><code>CrowdFunding::execute_operation</code><span> continues to create another cross-chain message </span><code>crowd_funding::Message::PledgeWithAccount</code><span>, which informs the crowd-funding application on Bob&#39;s chain that the 10 tokens are meant for the campaign.</span></p><p><span>When Bob now adds a block to his chain that handles the two incoming messages, first </span><code>Fungible::execute_message</code><span> gets executed, and then </span><code>CrowdFunding::execute_message</code><span>. The latter makes another cross-application call to transfer the 10 tokens from Carol&#39;s account to the crowd-funding application&#39;s account (both on Bob&#39;s chain). That is successful because Carol does now have 10 tokens on this chain and she authenticated the transfer indirectly by signing her block. The crowd-funding application now makes a note in its application state on Bob&#39;s chain that Carol has pledged 10 Pugecoin tokens.</span></p><p><span>For the complete code please take a look at the </span><code>crowd-funding</code><span> and </span><code>fungible</code><span> applications in the </span><code>examples</code><span> folder in </span><code>linera-protocol</code><span>.</span></p><h1><a name="printing-logs-from-an-applicationhttpslineradevsdklogginghtmlprinting-logs-from-an-application" class="md-header-anchor"></a><a href='https://linera.dev/sdk/logging.html#printing-logs-from-an-application'><span>Printing Logs from an Application</span></a></h1><p><span>Applications can use the </span><a href='https://crates.io/crates/log'><code>log</code><span> crate</span></a><span> to print log messages with different levels of importance. Log messages are useful during development, but they may also be useful for end users. By default the </span><code>linera service</code><span> command will log the messages from an application if they are of the &quot;info&quot; importance level or higher (briefly, </span><code>log::info!</code><span>, </span><code>log::warn!</code><span> and </span><code>log::error!</code><span>).</span></p><p><span>During development it is often useful to log messages of lower importance (such as </span><code>log::debug!</code><span> and </span><code>log::trace!</code><span>). To enable them, the </span><code>RUST_LOG</code><span> environment variable must be set before running </span><code>linera service</code><span>. The example below enables trace level messages from applications and enables warning level messages from other parts of the </span><code>linera</code><span> binary:</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="ignore"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="ignore"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">export RUST_LOG="warn,linera_execution::wasm=trace"</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 23px;"></div><div class="CodeMirror-gutters" style="display: none; height: 23px;"></div></div></div></pre><h1><a name="writing-testshttpslineradevsdktestinghtmlwriting-tests" class="md-header-anchor"></a><a href='https://linera.dev/sdk/testing.html#writing-tests'><span>Writing Tests</span></a></h1><p><span>Linera applications can be tested using unit tests or integration tests. Both are a bit different than usual Rust tests. Unit tests are executed inside a WebAssembly virtual machine in an environment that simulates a single microchain and a single application. System APIs are only available if they are mocked using helper functions from </span><code>linera_sdk::test</code><span>.</span></p><p><span>Integration tests run outside a WebAssembly virtual machine, and use a simulated validator for testing. This allows creating chains and adding blocks to them in order to test interactions between multiple microchains and multiple applications.</span></p><p><span>Applications should consider having both types of tests. Unit tests should be used to focus on the application&#39;s internals and core functionality. Integration tests should be used to test how the application behaves on a more complex environment that&#39;s closer to the real network.</span></p><blockquote><p><span>In most cases, the simplest way to run both unit tests and integration tests is to call </span><code>linera project test</code><span> from the project&#39;s directory.</span></p></blockquote><h2><a name="unit-testshttpslineradevsdktestinghtmlunit-tests" class="md-header-anchor"></a><a href='https://linera.dev/sdk/testing.html#unit-tests'><span>Unit tests</span></a></h2><p><span>Unit tests are written beside the application&#39;s source code (i.e., inside the </span><code>src</code><span> directory of the project). There are several differences to normal Rust unit tests:</span></p><ul><li><span>the target </span><code>wasm32-unknown-unknown</code><span> must be selected;</span></li><li><span>the custom test runner </span><code>linera-wasm-test-runner</code><span> must be used;</span></li><li><span>the </span><a href='https://docs.rs/webassembly-test/latest/webassembly_test/'><code>#[webassembly_test\]</code></a><span> attribute must be used instead of the usual </span><code>#[test]</code><span> attribute.</span></li></ul><p><span>The first two items are done automatically by </span><code>linera project test</code><span>.</span></p><p><span>Alternatively, one may set up the environment and run </span><code>cargo test</code><span> directly as described </span><a href='https://linera.dev/sdk/testing.html#manually-configuring-the-environment'><span>below</span></a><span>.</span></p><h3><a name="examplehttpslineradevsdktestinghtmlexample" class="md-header-anchor"></a><a href='https://linera.dev/sdk/testing.html#example'><span>Example</span></a></h3><p><span>A simple unit test is shown below, which tests if the application&#39;s </span><code>do_something</code><span> method changes the application state.</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="rust" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="rust"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-meta">#[cfg(test)]</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">mod</span> <span class="cm-def">tests</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">use</span> <span class="cm-keyword">crate</span>::<span class="cm-variable">state</span>::<span class="cm-variable">ApplicationState</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">use</span> <span class="cm-variable">webassembly_test</span>::<span class="cm-variable">webassembly_test</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-meta">#[webassembly_test]</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">fn</span> <span class="cm-def">test_do_something</span>() {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">let mut</span> <span class="cm-def">application</span> <span class="cm-operator">=</span> <span class="cm-variable">ApplicationState</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-comment">// Configure the application's initial state</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ..<span class="cm-variable">ApplicationState</span>::<span class="cm-variable">default</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  };</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">let</span> <span class="cm-def">result</span> <span class="cm-operator">=</span> <span class="cm-variable">application</span>.<span class="cm-variable">do_something</span>();</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable-3">assert!</span>(<span class="cm-variable">result</span>.<span class="cm-variable">is_ok</span>());</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable-3">assert_eq!</span>(<span class="cm-variable">application</span>, <span class="cm-variable">ApplicationState</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-comment">// Define the application's expected final state</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ..<span class="cm-variable">ApplicationState</span>::<span class="cm-variable">default</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  });</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 483px;"></div><div class="CodeMirror-gutters" style="display: none; height: 483px;"></div></div></div></pre><h3><a name="mocking-system-apishttpslineradevsdktestinghtmlmocking-system-apis" class="md-header-anchor"></a><a href='https://linera.dev/sdk/testing.html#mocking-system-apis'><span>Mocking System APIs</span></a></h3><p><span>Unit tests run in a constrained environment, so things like access to the key-value store, cross-chain messages and cross-application calls can&#39;t be executed. However, they can be simulated using mock APIs. The </span><code>linera-sdk::test</code><span> module provides some helper functions to mock the system APIs.</span></p><p><span>Here&#39;s an example mocking the key-value store.</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="rust" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="rust"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-meta">#[cfg(test)]</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">mod</span> <span class="cm-def">tests</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">use</span> <span class="cm-keyword">crate</span>::<span class="cm-variable">state</span>::<span class="cm-variable">ApplicationState</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">use</span> <span class="cm-variable">linera_sdk</span>::<span class="cm-variable">test</span>::<span class="cm-variable">mock_key_value_store</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">use</span> <span class="cm-variable">webassembly_test</span>::<span class="cm-variable">webassembly_test</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-meta">#[webassembly_test]</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">fn</span> <span class="cm-def">test_state_is_not_persisted</span>() {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">let mut</span> <span class="cm-def">storage</span> <span class="cm-operator">=</span> <span class="cm-variable">mock_key_value_store</span>();</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-comment">// Assuming the application uses views</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">let mut</span> <span class="cm-def">application</span> <span class="cm-operator">=</span> <span class="cm-variable">ApplicationState</span>::<span class="cm-variable">load</span>(<span class="cm-variable">storage</span>.<span class="cm-variable">clone</span>())</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  .<span class="cm-variable">now_or_never</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  .<span class="cm-variable">expect</span>(<span class="cm-string">"Mock key-value store returns immediately"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  .<span class="cm-variable">expect</span>(<span class="cm-string">"Failed to load view from mock key-value store"</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-comment">// Assuming `do_something` changes the view, but does not persist it</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">let</span> <span class="cm-def">result</span> <span class="cm-operator">=</span> <span class="cm-variable">application</span>.<span class="cm-variable">do_something</span>();</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable-3">assert!</span>(<span class="cm-variable">result</span>.<span class="cm-variable">is_ok</span>());</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-comment">// Check that the state in memory is different from the state in storage</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable-3">assert_ne!</span>(<span class="cm-variable">application</span>, <span class="cm-variable">ApplicatonState</span>::<span class="cm-variable">load</span>(<span class="cm-variable">storage</span>));</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 575px;"></div><div class="CodeMirror-gutters" style="display: none; height: 575px;"></div></div></div></pre><h3><a name="running-unit-tests-with-cargo-testhttpslineradevsdktestinghtmlrunning-unit-tests-with-cargo-test" class="md-header-anchor"></a><a href='https://linera.dev/sdk/testing.html#running-unit-tests-with-cargo-test'><span>Running Unit Tests with </span><code>cargo test</code></a></h3><p><span>Running </span><code>linera project test</code><span> is easier, but if there&#39;s a need to run </span><code>cargo test</code><span> explicitly to run the unit tests, Cargo must be configured to use the custom test runner </span><code>linera-wasm-test-runner</code><span>. This binary can be built from the repository or installed with </span><code>cargo install linera-sdk</code><span>.</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="bash"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">cd</span> linera-protocol</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">cargo build <span class="cm-attribute">-p</span> linera-sdk <span class="cm-attribute">--bin</span> linera-wasm-test-runner <span class="cm-attribute">--release</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 46px;"></div><div class="CodeMirror-gutters" style="display: none; height: 46px;"></div></div></div></pre><p><span>The steps above build the </span><code>linera-wasm-test-runner</code><span> and places the resulting binary at </span><code>linera-protocol/target/release/linera-wasm-test-runner</code><span>.</span></p><p><span>With the binary available, the last step is to configure Cargo. There are a few ways to do this. A quick way is to set the </span><code>CARGO_TARGET_WASM32_UNKNOWN_UNKNOWN_RUNNER</code><span> environment variable to the path of the binary.</span></p><p><span>A more persistent way is to change one of </span><a href='https://doc.rust-lang.org/cargo/reference/config.html#hierarchical-structure'><span>Cargo&#39;s configuration files</span></a><span>. As an example, the following file can be placed inside the project&#39;s directory at </span><code>PROJECT_DIR/.cargo/config.toml</code><span>:</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="ignore"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="ignore"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[target.wasm32-unknown-unknown]</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">runner = "PATH_TO/linera-wasm-test-runner"</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 46px;"></div><div class="CodeMirror-gutters" style="display: none; height: 46px;"></div></div></div></pre><p><span>After configuring the test runner, unit tests can be executed with</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="bash"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">cargo test <span class="cm-attribute">--target</span> wasm32-unknown-unknown</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 23px;"></div><div class="CodeMirror-gutters" style="display: none; height: 23px;"></div></div></div></pre><p><span>Optionally, </span><code>wasm32-unknown-unknown</code><span> can be made the default build target with the following lines in </span><code>PROJECT_DIR/.cargo/config.toml</code><span>:</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="ignore"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="ignore"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[build]</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">target = "wasm32-unknown-unknown"</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 46px;"></div><div class="CodeMirror-gutters" style="display: none; height: 46px;"></div></div></div></pre><h2><a name="integration-testshttpslineradevsdktestinghtmlintegration-tests" class="md-header-anchor"></a><a href='https://linera.dev/sdk/testing.html#integration-tests'><span>Integration Tests</span></a></h2><p><span>Integration tests are usually written separately from the application&#39;s source code (i.e., inside a </span><code>tests</code><span> directory that&#39;s beside the </span><code>src</code><span> directory).</span></p><p><span>Integration tests are normal Rust integration tests, and they are compiled to the </span><strong><span>host</span></strong><span> target instead of the </span><code>wasm32-unknown-unknown</code><span> target used for unit tests. This is because unit tests run inside a WebAssembly virtual machine and integration tests run outside a virtual machine, starting isolated virtual machines to run each operation of each block added to each chain.</span></p><blockquote><p><span>Integration tests can be run with </span><code>linera project test</code><span> or simply </span><code>cargo test</code><span>.</span></p></blockquote><p><span>If you wish to use </span><code>cargo test</code><span> and have overridden your default target to be in </span><code>wasm32-unknown-unknown</code><span> in </span><code>.cargo/config.toml</code><span>, you will have to pass a native target to </span><code>cargo</code><span>, for instance </span><code>cargo test --target aarch64-apple-darwin</code><span>.</span></p><p><span>Integration tests use the helper types from </span><code>linera_sdk::test</code><span> to set up a simulated Linera network, and publish blocks to microchains in order to execute the application.</span></p><h3><a name="examplehttpslineradevsdktestinghtmlexample-1" class="md-header-anchor"></a><a href='https://linera.dev/sdk/testing.html#example-1'><span>Example</span></a></h3><p><span>A simple test that sends a message between application instances on different chains is shown below.</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="rust" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="rust"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-meta">#[tokio::test]</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">async</span> <span class="cm-keyword">fn</span> <span class="cm-def">test_cross_chain_message</span>() {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">let</span> (<span class="cm-variable">validator</span>, <span class="cm-variable">application_id</span>) <span class="cm-operator">=</span> <span class="cm-variable">TestValidator</span>::<span class="cm-variable">with_current_application</span>(<span class="cm-variable-3">vec!</span>[], <span class="cm-variable-3">vec!</span>[]).<span class="cm-variable">await</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">let mut</span> <span class="cm-def">sender_chain</span> <span class="cm-operator">=</span> <span class="cm-variable">validator</span>.<span class="cm-variable">get_chain</span>(<span class="cm-variable">application_id</span>.<span class="cm-variable">creation</span>.<span class="cm-variable">chain_id</span>).<span class="cm-variable">await</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">let mut</span> <span class="cm-def">receiver_chain</span> <span class="cm-operator">=</span> <span class="cm-variable">validator</span>.<span class="cm-variable">new_chain</span>().<span class="cm-variable">await</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">sender_chain</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  .<span class="cm-variable">add_block</span>(|<span class="cm-variable">block</span>| {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">block</span>.<span class="cm-variable">with_operation</span>(</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">application_id</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">Operation</span>::<span class="cm-variable">SendMessageTo</span>(<span class="cm-variable">receiver_chain</span>.<span class="cm-variable">id</span>()),</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  )</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  })</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  .<span class="cm-variable">await</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">receiver_chain</span>.<span class="cm-variable">handle_received_messages</span>().<span class="cm-variable">await</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">assert_eq!</span>(</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">receiver_chain</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  .<span class="cm-variable">query</span>::<span class="cm-operator">&lt;</span><span class="cm-variable">ChainId</span><span class="cm-operator">&gt;</span>(<span class="cm-variable">application_id</span>, <span class="cm-variable">Query</span>::<span class="cm-variable">LastSender</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  .<span class="cm-variable">await</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">sender_chain</span>.<span class="cm-variable">id</span>(),</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  );</span></pre><div class="" style="position: relative;"><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 575px;"></div><div class="CodeMirror-gutters" style="display: none; height: 575px;"></div></div></div></pre><h1><a name="advanced-topicshttpslineradevadvancedtopicshtmladvanced-topics" class="md-header-anchor"></a><a href='https://linera.dev/advanced_topics.html#advanced-topics'><span>Advanced Topics</span></a></h1><p><span>In this section, we present additional topics related to the Linera protocol.</span></p><h1><a name="viewshttpslineradevadvancedtopicsviewshtmlviews" class="md-header-anchor"></a><a href='https://linera.dev/advanced_topics/views.html#views'><span>Views</span></a></h1><blockquote><p><span>Views are a specific functionality of the Linera system that allow to have data in memory and then seamlessly flush it to an underlying persistent datastore.</span></p></blockquote><p><span>The </span><a href='https://docs.rs/linera-views/latest/linera_views/'><span>full documentation</span></a><span> is available on the crate documentation with all functions having examples.</span></p><p><span>Concretely, what is provided is the following:</span></p><ul><li><span>A trait </span><code>View</code><span> that provides </span><code>load</code><span>, </span><code>rollback</code><span>, </span><code>clear</code><span>, </span><code>flush</code><span>, </span><code>delete</code><span>. The idea is that we can do operation on the data and then flush it to the database storing them.</span></li><li><span>Several other traits </span><code>HashableView</code><span>, </span><code>RootView</code><span>, </span><code>CryptoHashView</code><span>, </span><code>CryptoHashRootView</code><span> that are important for computing hash.</span></li><li><span>A number of standard containers: </span><code>MapView</code><span>, </span><code>SetView</code><span>, </span><code>LogView</code><span>, </span><code>QueueView</code><span>, </span><code>RegisterView</code><span> that implement the </span><code>View</code><span> and </span><code>HashableView</code><span> traits.</span></li><li><span>Two containers </span><code>CollectionView</code><span> and </span><code>ReentrantCollectionView</code><span> that are similar to </span><code>MapView</code><span> but whose values are views themselves.</span></li><li><span>Derive macros that allow to implement the above mentioned traits on struct data types whose entries are views.</span></li></ul><h1><a name="persistent-storagehttpslineradevadvancedtopicspersistentstoragehtmlpersistent-storage" class="md-header-anchor"></a><a href='https://linera.dev/advanced_topics/persistent_storage.html#persistent-storage'><span>Persistent storage</span></a></h1><p><span>Validators run the servers and the data is stored in persistent storage. As a consequence we need a tool for working with persistent storage and so we have added </span><code>linera-db</code><span> for that purpose.</span></p><h2><a name="available-persistent-storagehttpslineradevadvancedtopicspersistentstoragehtmlavailable-persistent-storage" class="md-header-anchor"></a><a href='https://linera.dev/advanced_topics/persistent_storage.html#available-persistent-storage'><span>Available persistent storage</span></a></h2><p><span>The persistent storage that are available right now are </span><code>RocksDB</code><span>, </span><code>DynamoDB</code><span> and </span><code>ScyllaDB</code><span>. Each has its own strengths and weaknesses.</span></p><ul><li><a href='https://rocksdb.org/'><code>RocksDB</code></a><span>: Data is stored on disk and cannot be shared between shards but is very fast.</span></li><li><a href='https://aws.amazon.com/dynamodb/'><code>DynamoDB</code></a><span>: Data is stored on a remote storage, that has to be on AWS. Data can be shared between shards.</span></li><li><a href='https://www.scylladb.com/'><code>ScyllaDB</code></a><span>: Data is stored on a remote storage. Data can be shared between shards.</span></li></ul><p><span>There is no fundamental obstacle to the addition of other persistent storage solutions.</span></p><p><span>In addition, the </span><code>DynamoDB</code><span> and </span><code>ScyllaDB</code><span> have the notion of a table which means that a given remote location can be used for several completely independent purposes.</span></p><h2><a name="the-linera-db-toolhttpslineradevadvancedtopicspersistentstoragehtmlthe-linera-db-tool" class="md-header-anchor"></a><a href='https://linera.dev/advanced_topics/persistent_storage.html#the-linera-db-tool'><span>The </span><code>linera-db</code><span> tool</span></a></h2><p><span>When operating on a persistent storage some global operations can be required. The command line tool </span><code>linera-db</code><span> helps in making them work.</span></p><p><span>The functionalities are the following:</span></p><ul><li><code>list_tables</code><span>(</span><code>DynamoDB</code><span> and </span><code>ScyllaDB</code><span>): It lists all the tables that have been created on the persistent storage</span></li><li><code>initialize</code><span>(</span><code>RocksDB</code><span>, </span><code>DynamoDB</code><span> and </span><code>ScyllaDB</code><span>): It initializes a persistent storage.</span></li><li><code>check_existence</code><span>(</span><code>RocksDB</code><span>, </span><code>DynamoDB</code><span> and </span><code>ScyllaDB</code><span>): It tests the existence of a persistent storage. If the error code is 0 then the table exists, if the error code is 1 then the table is absent.</span></li><li><code>check_absence</code><span>(</span><code>RocksDB</code><span>, </span><code>DynamoDB</code><span> and </span><code>ScyllaDB</code><span>): It tests the absence of a persistent storage. If the error code is 0 then the table is absent, if the error code is 1 then the table does not exist.</span></li><li><code>delete_all</code><span>(</span><code>RocksDB</code><span>, </span><code>DynamoDB</code><span> and </span><code>ScyllaDB</code><span>): It deletes all the table of a persistent storage.</span></li><li><code>delete_single</code><span>(</span><code>DynamoDB</code><span> and </span><code>ScyllaDB</code><span>): It deletes a single table of a persistent storage.</span></li></ul><p><span>If some error occurs during the operation, then the error code 2 is returned and 0 if everything went fine with the exception of </span><code>check_existence</code><span> and </span><code>check_absence</code><span> for which the value 1 can occur if the connection with the database was established correctly but the result is not what we expected.</span></p><h1><a name="validatorshttpslineradevadvancedtopicsvalidatorshtmlvalidators" class="md-header-anchor"></a><a href='https://linera.dev/advanced_topics/validators.html#validators'><span>Validators</span></a></h1><p><span>Validators run the servers that allow users to download and create blocks. They validate, execute and cryptographically certify the blocks of all the chains.</span></p><blockquote><p><span>In Linera, every chain is backed by the same set of validators and has the same level of security.</span></p></blockquote><p><span>The main function of validators is to guarantee the integrity of the infrastructure in the sense that:</span></p><ul><li><span>Each block is valid, i.e. it has the correct format, its operations are allowed, the received messages are in the correct order, and e.g. the balance was correctly computed.</span></li><li><span>Every message received by one chain was actually sent by another chain.</span></li><li><span>If one block on a particular height is certified, no other block on the same height is.</span></li></ul><p><span>These properties are guaranteed to hold as long as two third of the validators (weighted by their stake) follow the protocol. In the future, deviating from the protocol may cause a validator to be considered malicious and to lose their </span><em><span>stake</span></em><span>.</span></p><p><span>Validators also play a role in the liveness of the system by making sure that the history of the chains stays available. However, since validators do not propose blocks on most chains (see </span><a href='https://linera.dev/advanced_topics/block_creation.html'><span>next section</span></a><span>), they do </span><em><span>not</span></em><span> guarantee that any particular operation or message will eventually be executed on a chain. Instead, chain owners decide whether and when to propose new blocks, and which operations and messages to include. The current implementation of the Linera client automatically includes all incoming messages in new blocks. The operations are the actions the chain owner explicitly adds, e.g. transfer.</span></p><h2><a name="architecture-of-a-validatorhttpslineradevadvancedtopicsvalidatorshtmlarchitecture-of-a-validator" class="md-header-anchor"></a><a href='https://linera.dev/advanced_topics/validators.html#architecture-of-a-validator'><span>Architecture of a validator</span></a></h2><p><span>Since every chain uses the same validators, adding more chains does not require adding validators. Instead, it requires each individual validator to scale out by adding more computation units, also known as &quot;workers&quot; or &quot;physical shards&quot;.</span></p><p><span>In the end, a Linera validator resembles a Web2 service made of</span></p><ul><li><span>a load balancer (aka. ingress/egress), currently implemented by the binary </span><code>linera-proxy</code><span>,</span></li><li><span>a number of workers, currently implemented by the binary </span><code>linera-server</code><span>,</span></li><li><span>a shared database, currently implemented by the abstract interface </span><code>linera-storage</code><span>.</span></li></ul><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="ignore" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="ignore"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Example of Linera network</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  │ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; │</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  │ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; │</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">┌───────────────────┼───────────────────┐ &nbsp; &nbsp; ┌───────────────────┼───────────────────┐</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">│ validator 1 &nbsp; &nbsp; &nbsp; │ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; │ &nbsp; &nbsp; │ validator N &nbsp; &nbsp; &nbsp; │ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; │</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">│ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ┌─────┴─────┐ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; │ &nbsp; &nbsp; │ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ┌─────┴─────┐ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; │</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">│ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; │ &nbsp; load &nbsp;  │ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; │ &nbsp; &nbsp; │ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; │ &nbsp; load &nbsp;  │ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; │</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">│ &nbsp; &nbsp; &nbsp; ┌─────┤  balancer ├────┐ &nbsp; &nbsp; &nbsp;  │ &nbsp; &nbsp; │ &nbsp; &nbsp; &nbsp; ┌─────┤  balancer ├──────┐ &nbsp; &nbsp;  │</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">│ &nbsp; &nbsp; &nbsp; │ &nbsp; &nbsp; └───────────┘ &nbsp;  │ &nbsp; &nbsp; &nbsp;  │ &nbsp; &nbsp; │ &nbsp; &nbsp; &nbsp; │ &nbsp; &nbsp; └─────┬─────┘ &nbsp; &nbsp;  │ &nbsp; &nbsp;  │</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">│ &nbsp; &nbsp; &nbsp; │ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  │ &nbsp; &nbsp; &nbsp;  │ &nbsp; &nbsp; │ &nbsp; &nbsp; &nbsp; │ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; │ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  │ &nbsp; &nbsp;  │</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">│ &nbsp; &nbsp; &nbsp; │ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  │ &nbsp; &nbsp; &nbsp;  │ &nbsp; &nbsp; │ &nbsp; &nbsp; &nbsp; │ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; │ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  │ &nbsp; &nbsp;  │</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">│  ┌────┴─────┐ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ┌────┴─────┐  │ &nbsp; &nbsp; │  ┌────┴───┐  ┌────┴────┐  ┌────┴───┐  │</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">│  │  worker  ├───────────┤  worker  │  │ ... │  │ worker ├──┤  worker ├──┤ worker │  │</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">│  │ &nbsp;  1 &nbsp; &nbsp; │ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; │ &nbsp;  2 &nbsp; &nbsp; │  │ &nbsp; &nbsp; │  │ &nbsp;  1 &nbsp; │  │ &nbsp;  2 &nbsp;  │  │ &nbsp;  3 &nbsp; │  │</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">│  └────┬─────┘ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; └────┬─────┘  │ &nbsp; &nbsp; │  └────┬───┘  └────┬────┘  └────┬───┘  │</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">│ &nbsp; &nbsp; &nbsp; │ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  │ &nbsp; &nbsp; &nbsp;  │ &nbsp; &nbsp; │ &nbsp; &nbsp; &nbsp; │ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; │ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  │ &nbsp; &nbsp;  │</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">│ &nbsp; &nbsp; &nbsp; │ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  │ &nbsp; &nbsp; &nbsp;  │ &nbsp; &nbsp; │ &nbsp; &nbsp; &nbsp; │ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; │ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  │ &nbsp; &nbsp;  │</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">│ &nbsp; &nbsp; &nbsp; │ &nbsp; &nbsp; ┌───────────┐ &nbsp;  │ &nbsp; &nbsp; &nbsp;  │ &nbsp; &nbsp; │ &nbsp; &nbsp; &nbsp; │ &nbsp; &nbsp; ┌─────┴─────┐ &nbsp; &nbsp;  │ &nbsp; &nbsp;  │</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">│ &nbsp; &nbsp; &nbsp; └─────┤  shared &nbsp; ├────┘ &nbsp; &nbsp; &nbsp;  │ &nbsp; &nbsp; │ &nbsp; &nbsp; &nbsp; └─────┤  shared &nbsp; ├──────┘ &nbsp; &nbsp;  │</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">│ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; │ database  │ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; │ &nbsp; &nbsp; │ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; │ database  │ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; │</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">│ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; └───────────┘ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; │ &nbsp; &nbsp; │ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; └───────────┘ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; │</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">└───────────────────────────────────────┘ &nbsp; &nbsp; └───────────────────────────────────────┘</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 529px;"></div><div class="CodeMirror-gutters" style="display: none; height: 529px;"></div></div></div></pre><p><span>Inside a validator, components communicate using the internal network of the validator. Notably, workers use direct Remote Procedure Calls (RPCs) with each other to deliver cross-chain messages.</span></p><p><span>Note that the number of workers may vary for each validator. Both the load balancer and the shared database are represented as a single entity but are meant to scale out in production.</span></p><blockquote><p><span>For local testing during development, we currently use a single worker and RocksDB as a database.</span></p></blockquote><h1><a name="creating-new-blockshttpslineradevadvancedtopicsblockcreationhtmlcreating-new-blocks" class="md-header-anchor"></a><a href='https://linera.dev/advanced_topics/block_creation.html#creating-new-blocks'><span>Creating New Blocks</span></a></h1><blockquote><p><span>In Linera, the responsibility of proposing blocks is separate from the task of validating blocks.</span></p></blockquote><p><span>While all chains are validated in the same way, the Linera protocol defines several types of chains, depending on how new blocks are produced.</span></p><ul><li><span>The simplest and lowest-latency type of chain is called </span><em><span>single-owner</span></em><span> chain.</span></li><li><span>Other types of Linera chains not currently supported in the SDK include </span><em><span>permissioned chains</span></em><span> and </span><em><span>public chains</span></em><span> (see the </span><a href='https://linera.io/whitepaper'><span>whitepaper</span></a><span> for more context).</span></li></ul><blockquote><p><span>For most types of chains (all but </span><em><span>public chains</span></em><span>), Linera validators do not need to exchange messages with each other.</span></p></blockquote><p><span>Instead, the wallets (aka. </span><code>linera</code><span> clients) of chain owners make the system progress by proposing blocks and actively providing any additional required data to the validators. For instance, client commands such as </span><code>transfer</code><span>, </span><code>publish-bytecode</code><span>, or </span><code>open-chain</code><span> perform multiple steps to append a block containing the token transfer, application publishing, or chain creation operation:</span></p><ul><li><span>The Linera client creates a new block containing the desired operation and new incoming messages, if there are any. It also contains the most recent block&#39;s hash to designate its parent. The client sends the new block to all validators.</span></li><li><span>The validators validate the block, i.e. check that the block satisfies the conditions listed above, and send a cryptographic signature to the client, indicating that they vote to append the new block. But only if they have not voted for a different block on the same height earlier!</span></li><li><span>The client ideally receives a vote from every validator, but only a quorum of votes (say, two thirds) are required: These constitute a &quot;certificate&quot;, proving that the block was confirmed. The client sends the certificate to every validator.</span></li><li><span>The validators &quot;execute&quot; the block: They update their own view of the most recent state of the chain by applying all messages and operations, and if it generated any cross-chain messages, they send these to the appropriate workers.</span></li></ul><p><span>To guarantee that each incoming message in a block was actually sent by another chain, a validator will, in the second step, only </span><em><span>vote</span></em><span> for a block if it has already executed the block that sent it. However, when receiving a valid certificate for a block that receives a message it has not seen yet, it will accept and </span><em><span>execute</span></em><span> the block anyway. The certificate is proof that most other validators have seen the message, so it must be correct.</span></p><p><span>In the case of single-owner chains, clients must be carefully implemented so that they never propose multiple blocks at the same height. Otherwise, the chain may be stuck: once each of the two conflicting blocks has been signed by enough validators, it becomes impossible to collect a quorum of votes for either block.</span></p><p><span>In the future, we anticipate that most users will use </span><em><span>permissioned chains</span></em><span> even if they are the only owners of their chains. Permissioned chains have two confirmation steps instead of one, but it is not possible to accidentally make a chain unextendable. They also allow users to delegate certain admistrative tasks to third-parties, notably to help with epoch changes (i.e. when the validators change if reconfigured).</span></p><h1><a name="appendix" class="md-header-anchor"></a><span>Appendix</span></h1><h1><a name="glossaryhttpslineradevappendixglossaryhtmlglossary" class="md-header-anchor"></a><a href='https://linera.dev/appendix/glossary.html#glossary'><span>Glossary</span></a></h1><ul><li><strong><span>Address</span></strong><span>: A unique public alphanumeric identifier used to designate the identity of an entity on the Linera network.</span></li><li><strong><span>Admin Chain</span></strong><span>: The Linera Network has one designated </span><em><span>admin chain</span></em><span> where validators can join or leave and where new epochs are defined.</span></li><li><strong><span>Application</span></strong><span>: Similar to a smart-contract on Ethereum, an application is code deployed on the Linera network which is executed by all validators. An application has a metered </span><em><span>contract</span></em><span> which executes &#39;business logic&#39; and modifies state and an unmetered &#39;service&#39; which is a read-only view into an application&#39;s state.</span></li><li><strong><span>Byzantine Fault-Tolerant (BFT)</span></strong><span>: A system which can operate correctly and achieve consensus even if components of the system fail or act maliciously.</span></li><li><strong><span>Block Height</span></strong><span>: The number of blocks preceding a given block on a specific microchain.</span></li><li><strong><span>Block Proposal</span></strong><span>: A candidate block proposed by a chain owner which may be selected at the next block height.</span></li><li><strong><span>Bytecode</span></strong><span>: A collection of bytes corresponding to a program that can be run by the Wasm virtual machine.</span></li><li><strong><span>Client</span></strong><span>: The </span><code>linera</code><span> program, which is a local node and wallet operated by users to make requests to the network. In Linera, clients drive the network by proposing new blocks and validators are mostly reactive.</span></li><li><strong><span>Certificate</span></strong><span>: A value with signatures from a quorum of validators. Values can be confirmed blocks, meaning that the block has been added to the chain and is final. There are other values that are used for reaching consensus, before certifying a confirmed block.</span></li><li><strong><span>Committee</span></strong><span>: The set of all validators for a particular </span><em><span>epoch</span></em><span>, together with their voting weights.</span></li><li><strong><span>Chain Owner</span></strong><span>: The owner of a </span><em><span>user chain</span></em><span> or </span><em><span>permissioned chain</span></em><span>. This is represented as the alphanumeric identifier derived from the hash of the owner&#39;s public key.</span></li><li><strong><span>Channel</span></strong><span>: A broadcast mechanism enabling publish-subscribe behavior across chains.</span></li><li><strong><span>Contract</span></strong><span>: The metered part of an application which executes business logic and can modify the application&#39;s state.</span></li><li><strong><span>Cross-Application Call</span></strong><span>: A call from one application to another on the </span><em><span>same chain</span></em><span>.</span></li><li><strong><span>Cross-Chain Message</span></strong><span>: A message containing a data payload which is sent from one chain to another. Cross-Chain messages are the asynchronous communication primitive which enable communication on the same application running on different chains.</span></li><li><strong><span>Epoch</span></strong><span>: A period of time when a particular set of validators with particular voting weights can certify new blocks. Since each chain has to transition explicitly from one epoch to the next, epochs can overlap.</span></li><li><strong><span>Genesis Configuration</span></strong><span>: The configuration determining the state of a newly created network; the voting weights of the initial set of validators, the initial fee structure, and initial chains that the network starts with.</span></li><li><strong><span>Inbox</span></strong><span>: A commutative data structure storing incoming messages for a given chain.</span></li><li><strong><span>Message</span></strong><span>: See &#39;Cross-Chain Message&#39;.</span></li><li><strong><span>Microchain</span></strong><span>: A lightweight chain of blocks holding a subset of the network&#39;s state running on every validator. This is used interchangeably with &#39;chain&#39;. </span><em><span>All</span></em><span> Linera chains are microchains.</span></li><li><strong><span>Network</span></strong><span>: The totality of all protocol participants. A network is the combination of committee, clients and auditors.</span></li><li><strong><span>Operation</span></strong><span>: Operations are transactions directly added to a block by the creator (and signer) of the block. Users typically use operations to start interacting with an application on their own chain.</span></li><li><strong><span>Permissioned Chain</span></strong><span>: A microchain which is owned by more than one user. Users take turns proposing blocks and the likelihood of selection is proportional to their </span><em><span>weight</span></em><span>.</span></li><li><strong><span>Project</span></strong><span>: The collection of files and dependencies which are built into the bytecode which is instantiated as an application on the Linera Network.</span></li><li><strong><span>Public Chain</span></strong><span>: A microchain with full BFT consensus with a strict set of permissions relied on for the operation of the network,</span></li><li><strong><span>Quorum</span></strong><span>: A set of validators representing &gt; ⅔ of the total stake. A quorum is required to create a certificate.</span></li><li><strong><span>Single-Owner Chain</span></strong><span>: See &#39;User Chain&#39;.</span></li><li><strong><span>Service</span></strong><span>: An unmetered read-only view into an application&#39;s state.</span></li><li><strong><span>Shard</span></strong><span>: A logical subset of all microchains on a given validator. This corresponds directly to a physical </span><em><span>worker</span></em><span>.</span></li><li><strong><span>Stake</span></strong><span>: An amount of tokens pledged by a validator or auditor, as a collateral to guarantee their honest and correct participation in the network.</span></li><li><strong><span>User Chain</span></strong><span>: Used interchangeably with </span><em><span>Single-Owner Chain</span></em><span>. User chains are chains which are owned by a single user on the network. Only the chain owner can propose blocks, and therefore only the chain owner can forcibly advance the state of a user chain.</span></li><li><strong><span>Validator</span></strong><span>: Validators run the servers that allow users to download and create blocks. They validate, execute and cryptographically certify the blocks of all the chains.</span></li><li><strong><span>View</span></strong><span>: Views are like an Object-Relational Mapping (ORM) for mapping complex types onto key-value stores. Views group complex state changes into a set of elementary operations and commit them atomically. They are full or partial in-memory representations of complex types saved on disk in a key-value store</span></li><li><strong><span>Wallet</span></strong><span>: A file containing a user&#39;s public and private keys along with configuration and information regarding the chains they own.</span></li><li><strong><span>WebAssembly (Wasm)</span></strong><span>: A binary compilation target and instruction format that runs on a stack-based VM. Linera applications are compiled to Wasm and run on Wasm VMs inside validators and clients.</span></li><li><strong><span>Web3</span></strong><span>: A natural evolution of the internet focusing on decentralization by leveraging blockchains and smart contracts.</span></li><li><strong><span>Worker</span></strong><span>: A process which runs a subset of all microchains on a given validator. This corresponds directly to a logical </span><em><span>shard</span></em><span>.</span></li></ul><h1><a name="videoshttpslineradevvideoshtmlvideos" class="md-header-anchor"></a><a href='https://linera.dev/videos.html#videos'><span>Videos</span></a></h1><p><span>We&#39;re consistently improving the SDK and creating new material. We recorded the following tutorial videos for the Linera Developer Summer School 2023:</span></p><ul><li><a href='https://www.youtube.com/watch?v=Zr6BWodQ0sI'><span>Build and deploy your first applications</span></a></li><li><a href='https://www.youtube.com/watch?v=Aq9jCeEl02k'><span>Add testing, logging, and more to your app</span></a></li><li><a href='https://www.youtube.com/watch?v=5M5Ju35AnPE'><span>Use cross-application calls to call other apps</span></a></li></ul><p><em><span>Happy viewing!</span></em></p></div>
</body>
</html>
